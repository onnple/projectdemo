<!DOCTYPE html>
<!-- saved from url=(0088)https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges -->
<html lang="en-us" data-scheme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="这篇文章记录了对几种分流上网方案（iptables、OSPF、DNS 等）的尝试与优劣比较，文中会详细介绍博主目前使用的基于 DNS 的分流方案的原理"><meta name="keywords" content="DNS,PBR,Clash,MosDNS,策略路由"><title>巧用 DNS 实现国内外域名 ip 分流上网</title><link rel="canonical" href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges"><link rel="stylesheet" href="./post_files/style.min.css"><script>function addLoadEvent(e){var t=window.onload;typeof window.onload!="function"?window.onload=e:window.onload=function(){t(),e()}}</script><script id="page-manipulator-event-target-creator" src="chrome-extension://mdhellggnoabbnnchkeniomkpghbekko/receiver.js"></script><span id="page-manipulator-event-target"></span><meta property="og:title" content="巧用 DNS 实现国内外域名 ip 分流上网"><meta property="og:description" content="这篇文章记录了对几种分流上网方案（iptables、OSPF、DNS 等）的尝试与优劣比较，文中会详细介绍博主目前使用的基于 DNS 的分流方案的原理"><meta property="og:url" content="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges"><meta property="og:site_name" content="SSpiritsの秘密基地"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="DNS"><meta property="article:tag" content="PBR"><meta property="article:tag" content="Clash"><meta property="article:tag" content="MosDNS"><meta property="article:tag" content="策略路由"><meta property="article:published_time" content="2022-06-03T21:03:00+08:00"><meta property="article:modified_time" content="2022-09-02T02:13:45+08:00"><meta property="og:image" content="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges/dns.png"><meta name="twitter:title" content="巧用 DNS 实现国内外域名 ip 分流上网"><meta name="twitter:description" content="这篇文章记录了对几种分流上网方案（iptables、OSPF、DNS 等）的尝试与优劣比较，文中会详细介绍博主目前使用的基于 DNS 的分流方案的原理"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges/dns.png"><link rel="shortcut icon" href="https://blog.lv5.moe/favicon.ico"><script async="" defer="" data-website-id="3f278efc-35a9-46c8-8359-dcc0e76f7af3" src="./post_files/umami.js.下载" data-cache="true" data-domains="blog.lv5.moe"></script>
<script async="" src="./post_files/js"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QNTL14TJQR",{anonymize_ip:!1})}</script><link href="./post_files/css2" type="text/css" rel="stylesheet"><style type="text/css">#_copy{align-items:center;background:#4494d5;border-radius:3px;color:#fff;cursor:pointer;display:flex;font-size:13px;height:30px;justify-content:center;position:absolute;width:60px;z-index:1000}#select-tooltip,#sfModal,.modal-backdrop,div[id^=reader-helper]{display:none!important}.modal-open{overflow:auto!important}._sf_adjust_body{padding-right:0!important}.super_copy_btns_div{position:fixed;width:154px;left:10px;top:45%;background:#e7f1ff;border:2px solid #4595d5;font-weight:600;border-radius:2px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;z-index:5000}.super_copy_btns_logo{width:100%;background:#4595d5;text-align:center;font-size:12px;color:#e7f1ff;line-height:30px;height:30px}.super_copy_btns_btn{display:block;width:128px;height:28px;background:#7f5711;border-radius:4px;color:#fff;font-size:12px;border:0;outline:0;margin:8px auto;font-weight:700;cursor:pointer;opacity:.9}.super_copy_btns_btn:hover{opacity:.8}.super_copy_btns_btn:active{opacity:1}</style><style>:root{--waline-font-size: 16px;--waline-white: #fff;--waline-light-grey: #999;--waline-dark-grey: #666;--waline-theme-color: #27ae60;--waline-active-color: #2ecc71;--waline-text-color: #444;--waline-bgcolor: #fff;--waline-bgcolor-light: #f8f8f8;--waline-bgcolor-hover: #f0f0f0;--waline-border-color: #ddd;--waline-disable-bgcolor: #f8f8f8;--waline-disable-color: #000;--waline-code-bgcolor: #282c34;--waline-bq-color: #f0f0f0;--waline-avatar-size: 3.25rem;--waline-mobile-avatar-size: calc(var(--waline-avatar-size) * 9 / 13);--waline-badge-color: #3498db;--waline-badge-font-size: 0.775em;--waline-info-bgcolor: #f8f8f8;--waline-info-color: #999;--waline-info-font-size: 0.625em;--waline-border: 1px solid var(--waline-border-color);--waline-avatar-radius: 50%;--waline-box-shadow: none}.v[data-class=v]{font-size:var(--waline-font-size);text-align:left}.v[data-class=v] *{box-sizing:content-box;line-height:1.75}.v[data-class=v] p{color:var(--waline-text-color)}.v[data-class=v] a{position:relative;display:inline-block;color:var(--waline-theme-color);text-decoration:none;cursor:pointer}.v[data-class=v] a:hover{color:var(--waline-active-color)}.v[data-class=v] img{max-width:100%;max-height:400px;border:none}.v[data-class=v] hr{margin:.825em 0;border-style:dashed;border-color:var(--waline-bgcolor-light)}.v[data-class=v] code,.v[data-class=v] pre{margin:0;padding:.2em .4em;border-radius:3px;background:var(--waline-bgcolor-light);font-size:85%}.v[data-class=v] pre{overflow:auto;padding:10px;line-height:1.45}.v[data-class=v] pre::-webkit-scrollbar{width:6px;height:6px}.v[data-class=v] pre::-webkit-scrollbar-track-piece:horizontal{border-radius:6px;background:rgba(0,0,0,.1)}.v[data-class=v] pre::-webkit-scrollbar-thumb:horizontal{width:6px;border-radius:6px;background:var(--waline-theme-color)}.v[data-class=v] pre code{padding:0;background:transparent;color:var(--waline-text-color);white-space:pre-wrap;word-break:keep-all}.v[data-class=v] blockquote{margin:.5em 0;padding:.5em 0 .5em 1em;border-left:8px solid var(--waline-bq-color);color:var(--waline-dark-grey)}.v[data-class=v] blockquote>p{margin:0}.v[data-class=v] ol,.v[data-class=v] ul{margin-left:1.25em;padding:0}.v[data-class=v] input[type=checkbox],.v[data-class=v] input[type=radio]{display:inline-block;vertical-align:middle;margin-top:-2px}.v[data-class=v] .vbtn{display:inline-block;vertical-align:middle;min-width:2.5em;margin-bottom:0;padding:.5em 1em;border:1px solid var(--waline-border-color);border-radius:.5em;background:transparent;color:var(--waline-text-color);font-weight:400;font-size:.75em;line-height:1.5;text-align:center;white-space:nowrap;cursor:pointer;-webkit-user-select:none;user-select:none;transition-duration:.4s;touch-action:manipulation}.v[data-class=v] .vbtn:hover,.v[data-class=v] .vbtn:active{border-color:var(--waline-theme-color);color:var(--waline-theme-color)}.v[data-class=v] .vbtn:disabled{border-color:var(--waline-border-color);background:var(--waline-disable-bgcolor);color:var(--waline-disable-color);cursor:not-allowed}.v[data-class=v] .vbtn.primary{border-color:var(--waline-theme-color);background:var(--waline-theme-color);color:var(--waline-white)}.v[data-class=v] .vbtn.primary:hover,.v[data-class=v] .vbtn.primary:active{border-color:var(--waline-active-color);background:var(--waline-active-color);color:var(--waline-white)}.v[data-class=v] .vbtn.primary:disabled{border-color:var(--waline-border-color);background:var(--waline-disable-bgcolor);color:var(--waline-disable-color);cursor:not-allowed}.v[data-class=v] .vloading{text-align:center}.v[data-class=v] .vloading svg{margin:0 auto}.v[data-class=v] .vcomment{position:relative;display:flex;margin-bottom:.75em}.v[data-class=v] .vclose{position:absolute;top:-4px;right:-4px;padding:0;border:none;background:transparent;line-height:1;cursor:pointer}.v[data-class=v] .vlogin-info{max-width:80px;margin-top:.75em;text-align:center}.v[data-class=v] .vlogout-btn{position:absolute;top:-10px;right:-10px;padding:3px;border:none;background:transparent;line-height:0;cursor:pointer}.v[data-class=v] .vavatar{position:relative;width:var(--waline-avatar-size);height:var(--waline-avatar-size);margin:0 auto;border:var(--waline-border);border-radius:var(--waline-avatar-radius)}@media(max-width: 720px){.v[data-class=v] .vavatar{width:var(--waline-mobile-avatar-size);height:var(--waline-mobile-avatar-size)}}.v[data-class=v] .vavatar img{width:100%;height:100%;border-radius:var(--waline-avatar-radius)}.v[data-class=v] .vlogin-nick{display:block;color:var(--waline-theme-color);font-size:.75em;word-break:break-all}.v[data-class=v] .vpanel{position:relative;width:100%;flex-shrink:1;margin:.5em;border:var(--waline-border);border-radius:.75em;background:var(--waline-bgcolor);box-shadow:var(--waline-box-shadow)}.v[data-class=v] .vheader{display:flex;padding:0 4px;border-bottom:2px dashed var(--waline-border-color);border-top-left-radius:.75em;border-top-right-radius:.75em;overflow:hidden}@media(max-width: 580px){.v[data-class=v] .vheader{display:block}}.v[data-class=v] .vheader .vheader-item{display:flex;flex:1}@media(max-width: 580px){.v[data-class=v] .vheader .vheader-item:not(:last-child){border-bottom:2px dashed var(--waline-border-color)}}.v[data-class=v] .vheader.vheader-1 .vheader-item{width:100%}.v[data-class=v] .vheader.vheader-2 .vheader-item{width:50%}@media(max-width: 580px){.v[data-class=v] .vheader.vheader-2 .vheader-item{flex:0;width:100%}}.v[data-class=v] .vheader.vheader-3 .vheader-item{width:33.33%}@media(max-width: 580px){.v[data-class=v] .vheader.vheader-3 .vheader-item{width:100%}}.v[data-class=v] .vheader label{min-width:40px;padding:.75em .5em;color:var(--waline-text-color);font-size:.75em;text-align:center}.v[data-class=v] .vheader input{flex:1;width:0;padding:.5em;background:transparent;font-size:.625em;resize:none}.v[data-class=v] .veditor,.v[data-class=v] .vinput{max-width:100%;border:none;color:var(--waline-text-color);outline:none;transition:all .25s ease}.v[data-class=v] .veditor:focus,.v[data-class=v] .vinput:focus{background:var(--waline-bgcolor-light)}.v[data-class=v] .veditor{position:relative;width:calc(100% - 1em);min-height:8.75em;margin:.75em .5em;border-radius:.5em;background:transparent;font-size:.875em;resize:vertical}.v[data-class=v] .vpreview{padding:0 .5em .5em}.v[data-class=v] .vpreview h4{margin:.25em;font-weight:bold;font-size:.9375em}.v[data-class=v] .vpreview .vcontent{padding:.25em;min-height:1.25em;border:var(--waline-border);border-radius:.25em;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.v[data-class=v] .vpreview .vcontent>*:first-child{margin-top:0}.v[data-class=v] .vpreview .vcontent>*:last-child{margin-bottom:0}.v[data-class=v] .vfooter{position:relative;display:flex;flex-wrap:wrap;margin:.5em .75em}.v[data-class=v] .vactions{display:flex;flex:2;align-items:center}.v[data-class=v] .vaction{width:1.5em;height:1.5em;border:none;margin:2px;padding:0;background:transparent;font-size:16px;cursor:pointer;color:var(--waline-text-color);display:inline-flex;justify-content:center;align-items:center}.v[data-class=v] .vaction:hover{color:var(--waline-theme-color)}.v[data-class=v] .vaction.actived{color:var(--waline-active-color)}.v[data-class=v] #waline-image-upload{display:none}.v[data-class=v] #waline-image-upload:focus+label{color:var(--waline-text-color)}.v[data-class=v] #waline-image-upload:focus-visible+label{outline:-webkit-focus-ring-color auto 1px}.v[data-class=v] .vinfo{display:flex;flex:3;align-items:center;justify-content:flex-end}.v[data-class=v] .vinfo .vtext-number{color:var(--waline-info-color);font-size:.75em}.v[data-class=v] .vinfo .vtext-number .illegal{color:red}.v[data-class=v] .vinfo button{margin-left:.75em}.v[data-class=v] .vinfo button svg{display:block;margin:0 auto;line-height:18px}.v[data-class=v] .vemoji-popup{position:absolute;top:100%;left:1.25em;z-index:10;max-width:526px;border:var(--waline-border);border-radius:6px;background:var(--waline-bgcolor);box-shadow:var(--waline-box-shadow);visibility:hidden;opacity:0;transform:scale(0.9, 0.9);transform-origin:0 0;transition:transform .2s ease-out,opacity .2s ease-out}.v[data-class=v] .vemoji-popup.display{visibility:visible;opacity:1;transform:none}.v[data-class=v] .vemoji-popup button{display:inline-block;vertical-align:middle;background:transparent;width:2em;margin:.125em;padding:0;border-width:0;font-size:inherit;line-height:2;text-align:center;cursor:pointer}.v[data-class=v] .vemoji-popup button:hover{background:var(--waline-bgcolor-hover)}.v[data-class=v] .vemoji-popup .vemoji{display:inline-block;vertical-align:middle;max-width:1.5em;max-height:1.5em}.v[data-class=v] .vemoji-popup .vtab-wrapper{max-height:145px;overflow-y:auto;padding:.5em}.v[data-class=v] .vemoji-popup .vtab-wrapper::-webkit-scrollbar{width:6px;height:6px}.v[data-class=v] .vemoji-popup .vtab-wrapper::-webkit-scrollbar-track-piece:vertical{border-radius:6px;background:rgba(0,0,0,.1)}.v[data-class=v] .vemoji-popup .vtab-wrapper::-webkit-scrollbar-thumb:vertical{width:6px;border-radius:6px;background:var(--waline-theme-color)}.v[data-class=v] .vemoji-popup .vtabs{position:relative;height:2em;padding:0 6px}.v[data-class=v] .vemoji-popup .vtabs::before{content:" ";position:absolute;z-index:2;left:0;top:0;right:0;height:1px;background:var(--waline-border-color)}.v[data-class=v] .vemoji-popup .vtab{position:relative;margin:0;padding:0 .5em}.v[data-class=v] .vemoji-popup .vtab.active{z-index:3;background:var(--waline-bgcolor);border:1px solid var(--waline-border-color);border-top-width:0;border-bottom-left-radius:6px;border-bottom-right-radius:6px}.v[data-class=v] .vcards .vitem{position:relative;display:flex;padding:.5em}.v[data-class=v] .vcards .vitem .vuser{width:var(--waline-avatar-size);height:var(--waline-avatar-size);margin-right:.75em;border-radius:var(--waline-avatar-radius);box-shadow:var(--waline-box-shadow)}@media(max-width: 720px){.v[data-class=v] .vcards .vitem .vuser{width:var(--waline-mobile-avatar-size);height:var(--waline-mobile-avatar-size)}}.v[data-class=v] .vcards .vitem:last-child .vcard{border-bottom:none}.v[data-class=v] .vcards .vcard .vitem{padding-right:0}.v[data-class=v] .vcard{flex:1;width:0;padding-bottom:.5em;border-bottom:1px dashed var(--waline-border-color)}.v[data-class=v] .vcard:first-child{margin-left:1em}.v[data-class=v] .vcard .vhead{line-height:1.5}.v[data-class=v] .vcard .vhead .vnick{position:relative;display:inline-block;margin-right:.5em;font-weight:bold;font-size:.875em;line-height:1;text-decoration:none}.v[data-class=v] .vcard .vhead .vnick svg{position:relative;bottom:-0.125em;line-height:1}.v[data-class=v] .vcard .vhead span.vnick{color:var(--waline-dark-grey)}.v[data-class=v] .vcard .vhead .vbadge{display:inline-block;margin-right:.5em;padding:0 .3em;border-radius:3px;background:var(--waline-badge-color);color:var(--waline-white);font-size:var(--waline-badge-font-size)}.v[data-class=v] .vcard .vhead .vtime{margin-right:.875em;color:var(--waline-info-color);font-size:.75em}.v[data-class=v] .vcard .vhead .vreply{float:right;cursor:pointer;padding:4px;border:none;background:transparent;color:var(--waline-text-color);line-height:1;transition:color .2s ease}.v[data-class=v] .vcard .vhead .vreply:hover{color:var(--waline-theme-color)}.v[data-class=v] .vcard .vhead .vreply.active{color:var(--waline-active-color)}.v[data-class=v] .vcard .vmeta{position:relative;line-height:1}.v[data-class=v] .vcard .vmeta>span{display:inline-block;margin-right:.25em;padding:2px 4px;border-radius:.2em;background:var(--waline-info-bgcolor);color:var(--waline-info-color);font-size:var(--waline-info-font-size);line-height:1.5}@media(max-width: 520px){.v[data-class=v] .vcard .vmeta>span{display:none}}.v[data-class=v] .vcard .vmeta>span:empty{display:none}.v[data-class=v] .vcard .vcontent{line-height:2;position:relative;margin-bottom:.75em;padding-top:.625em;font-size:.875em;word-wrap:break-word}.v[data-class=v] .vcard .vcontent.expand{overflow:hidden;max-height:8em;cursor:pointer}.v[data-class=v] .vcard .vcontent.expand::before{content:"";position:absolute;top:0;bottom:3.15em;left:0;z-index:999;display:block;width:100%;background:linear-gradient(180deg, #000, rgba(255, 255, 255, 0.9))}.v[data-class=v] .vcard .vcontent.expand::after{content:attr(data-expand);position:absolute;bottom:0;left:0;z-index:999;display:block;width:100%;height:3.15em;background:rgba(255,255,255,.9);color:#828586;line-height:3.15em;text-align:center}.v[data-class=v] .vcard .vcontent>*:first-child{margin-top:0}.v[data-class=v] .vcard .vcontent>*:last-child{margin-bottom:0}.v[data-class=v] .vcard .vquote{border-left:1px dashed rgba(237,237,237,.5)}.v[data-class=v] .vcard .vquote .vuser{width:var(--waline-mobile-avatar-size);height:var(--waline-mobile-avatar-size)}.v[data-class=v] .vclose-icon{color:var(--waline-border-color)}.v[data-class=v] .vcontent .vemoji{display:inline-block;vertical-align:middle;width:1.25em;margin:.25em}.v[data-class=v] .vcontent .vtex{background:var(--waline-info-bgcolor);color:var(--waline-info-color)}.v[data-class=v] .vcontent span.vtex{display:inline-block;margin-right:.25em;padding:2px 4px;border-radius:.2em;font-size:var(--waline-info-font-size);line-height:1.5}.v[data-class=v] .vcontent p.vtex{text-align:center}.v[data-class=v] .vcontent .katex-display{padding-top:.2em;padding-bottom:.2em;overflow:auto hidden;-webkit-overflow-scrolling:touch}.v[data-class=v] .vcontent .katex-display::-webkit-scrollbar{height:3px}.v[data-class=v] .vcontent .katex-error{color:red}.v[data-class=v] .vcount{padding:.375em;font-weight:bold;font-size:1.25em}.v[data-class=v] .vempty{overflow:auto;padding:1.25em;color:var(--waline-text-color);text-align:center}.v[data-class=v] .vmore{text-align:center}.v[data-class=v] .vmore button{margin:1em 0}.v[data-class=v] .vpower{padding:.5em 0;color:var(--waline-light-grey);font-size:var(--waline-info-font-size);text-align:right}.v[data-class=v] pre,.v[data-class=v] pre[class*=language-]{line-height:1.4;padding:1rem 1.25rem;margin:.75rem 0;background:var(--waline-code-bgcolor);border-radius:6px;overflow:auto}.v[data-class=v] pre code,.v[data-class=v] pre[class*=language-] code{color:#bbb;padding:0;background:transparent !important;border-radius:0}.v[data-class=v] code[class*=language-],.v[data-class=v] pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;-moz-tab-size:4;tab-size:4;-webkit-hyphens:none;hyphens:none}.v[data-class=v] pre[class*=language-]{overflow:auto}.v[data-class=v] :not(pre)>code[class*=language-],.v[data-class=v] pre[class*=language-]{background:#2d2d2d}.v[data-class=v] :not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.v[data-class=v] .token.comment,.v[data-class=v] .token.block-comment,.v[data-class=v] .token.prolog,.v[data-class=v] .token.doctype,.v[data-class=v] .token.cdata{color:#999}.v[data-class=v] .token.punctuation{color:#ccc}.v[data-class=v] .token.tag,.v[data-class=v] .token.attr-name,.v[data-class=v] .token.namespace,.v[data-class=v] .token.deleted{color:#e2777a}.v[data-class=v] .token.function-name{color:#6196cc}.v[data-class=v] .token.boolean,.v[data-class=v] .token.number,.v[data-class=v] .token.function{color:#f08d49}.v[data-class=v] .token.property,.v[data-class=v] .token.class-name,.v[data-class=v] .token.constant,.v[data-class=v] .token.symbol{color:#f8c555}.v[data-class=v] .token.selector,.v[data-class=v] .token.important,.v[data-class=v] .token.atrule,.v[data-class=v] .token.keyword,.v[data-class=v] .token.builtin{color:#cc99cd}.v[data-class=v] .token.string,.v[data-class=v] .token.char,.v[data-class=v] .token.attr-value,.v[data-class=v] .token.regex,.v[data-class=v] .token.variable{color:#7ec699}.v[data-class=v] .token.operator,.v[data-class=v] .token.entity,.v[data-class=v] .token.url{color:#67cdcc}.v[data-class=v] .token.important,.v[data-class=v] .token.bold{font-weight:bold}.v[data-class=v] .token.italic{font-style:italic}.v[data-class=v] .token.entity{cursor:help}.v[data-class=v] .token.inserted{color:green}.waline-widget-item p{display:inline}</style><style>html[data-scheme="dark"]{--waline-white:#000;--waline-light-grey:#666;--waline-dark-grey:#999;--waline-text-color:#888;--waline-bgcolor:#1e1e1e;--waline-bgcolor-light:#272727;--waline-bgcolor-hover: #444;--waline-border-color:#333;--waline-disable-bgcolor:#444;--waline-disable-color:#272727;--waline-bq-color:#272727;--waline-info-bgcolor:#272727;--waline-info-color:#666}</style></head><body class="article-page" waline-dark="" style="transition: background-color 0.3s ease 0s;"><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex
&lt;!--
extended
--&gt;
on-phone--column extended"><div id="article-toolbar"><a href="https://blog.lv5.moe/" class="back-home"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><polyline points="15 6 9 12 15 18"></polyline></svg><span>Back</span></a></div><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
<span class="hamburger-box"><span class="hamburger-inner"></span></span></button><header class="site-info"><figure class="site-avatar"><img src="./post_files/avatar_hu6d9469b8bfc8dfa514aef419be5b4fe8_57345_300x0_resize_q75_box.jpg" width="300" height="299" class="site-logo" loading="lazy" alt="Avatar">
<span class="emoji">🍥</span></figure><h1 class="site-name"><a href="https://blog.lv5.moe/">SSpiritsの秘密基地</a></h1><h2 class="site-description">わたし、気になります！</h2><ol class="social-menu"><li><a href="mailto:admin@lv5.moe" target="_blank" title="Email"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><rect x="3" y="5" width="18" height="14" rx="2"></rect><polyline points="3 7 12 13 21 7"></polyline></svg></a></li><li><a href="https://github.com/ShadowySpirits" target="_blank" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"></path></svg></a></li></ol></header><ol class="menu" id="main-menu"><li><a href="https://blog.lv5.moe/"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><polyline points="5 12 3 12 12 3 21 12 19 12"></polyline><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"></path><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"></path></svg><span>Home</span></a></li><li><a href="https://blog.lv5.moe/about"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="12" cy="7" r="4"></circle><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"></path></svg><span>About</span></a></li><li><a href="https://blog.lv5.moe/archives"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><rect x="3" y="4" width="18" height="4" rx="2"></rect><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"></path><line x1="10" y1="12" x2="14" y2="12"></line></svg><span>Archives</span></a></li><li><a href="https://blog.lv5.moe/search"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="10" cy="10" r="7"></circle><line x1="21" y1="21" x2="15" y2="15"></line></svg><span>Search</span></a></li><li><a href="https://blog.lv5.moe/index.xml"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="5" cy="19" r="1"></circle><path d="M4 4a16 16 0 0116 16"></path><path d="M4 11a9 9 0 019 9"></path></svg><span>RSS</span></a></li><li id="dark-mode-toggle"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="8" cy="12" r="2"></circle><rect x="2" y="6" width="20" height="12" rx="6"></rect></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="16" cy="12" r="2"></circle><rect x="2" y="6" width="20" height="12" rx="6"></rect></svg><span>Dark Mode</span></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class="article-header"><div class="article-image"><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges"><img src="./post_files/dns.png" width="960" height="440" loading="eager" alt="Featured image of post 巧用 DNS 实现国内外域名 ip 分流上网"></a></div><div class="article-details"><header class="article-category"><a href="https://blog.lv5.moe/categories/share" style="background-color:green;color:#fff">杂七杂八的分享</a></header><h2 class="article-title"><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges">巧用 DNS 实现国内外域名 ip 分流上网</a></h2><h3 class="article-subtitle">这篇文章记录了对几种分流上网方案（iptables、OSPF、DNS 等）的尝试与优劣比较，文中会详细介绍博主目前使用的基于 DNS 的分流方案的原理</h3><footer class="article-time"><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"></path><circle cx="18" cy="18" r="4"></circle><path d="M15 3v4"></path><path d="M7 3v4"></path><path d="M3 11h16"></path><path d="M18 16.496V18l1 1"></path></svg><time class="article-time--published">Jun 03, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="12" cy="12" r="9"></circle><polyline points="12 7 12 12 15 15"></polyline></svg><time class="article-time--reading">7 minute read</time></div><div id="visitor-count"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-book" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M3 19a9 9 0 019 0 9 9 0 019 0"></path><path d="M3 6a9 9 0 019 0 9 9 0 019 0"></path><line x1="3" y1="6" x2="3" y2="19"></line><line x1="12" y1="6" x2="12" y2="19"></line><line x1="21" y1="6" x2="21" y2="19"></line></svg><span id="/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges" class="waline-visitor-count">4855</span>&nbsp;visitors</div></footer></div></header><section class="article-content"><p>这篇文章记录了对几种分流上网方案（iptables、OSPF、DNS 等）的尝试与优劣比较，文中会详细介绍博主目前使用的基于 DNS 的分流方案的原理与配置教程</p><h2 id="前言">前言</h2><p>本文适合使用软路由做透明代理的同学阅读，并且需要有一定的网络基础知识。如果你是一个小白那么直接跳到<code>极简配置</code>部分照着操作即可</p><p>博主尝试过如下几种思路实现策略路由（PBR, <a class="link" href="https://en.wikipedia.org/wiki/Policy-based_routing" target="_blank" rel="noopener">Policy Based Routing</a>）</p><ol><li>iptables 给链接打标</li><li>OSPF 等路由协议</li><li>Clash、V2ray 等代理工具</li><li>DNS 分流</li></ol><p>前两者的思路类似，都是使用中国 ip 白名单来将国外 ip 转发到旁路由等透明代理设备上。但是无论是 iptables 还是 OSPF 配置都非常复杂，特别是 OSPF 等路由协议科班出身的人都不一定玩得转。我们配置家庭网络追求的是简单好用，使用这样复杂的方案前期调试以及后期更新 ip 列表都很不方便</p><p>使用代理工具的分流功能做策略路由简单实用，Clash、V2ray 等客户端都会有开箱即用的配置提供。但是缺点也很明显：所有的流量都会经过代理程序，无法做到分设备代理，对于有有 BT、PCDN 等需求只想部分设备走代理的同学不太适用</p><p>使用 DNS 分流方案拥有 iptables 和 OSPF 做策略路由的丰富功能，并且兼具使用代理工具分流配置简单的优点</p><ol><li>丰富的分流策略：可以按国内外 ip 分流也可以按域名分流</li><li>配置简单：最简单的使用方法只需修改 Clash 的配置即可</li><li>去广告：可以阻断广告域名的 DNS 解析来禁止广告加载</li><li>分设备代理：对需要代理的设备使用分流 DNS 转发到代理服务器，其他设备使用上游公共 DNS 直连出公网</li></ol><p>但是这个方案也有缺点，对于直接使用 ip 的软件就无能为力了。当然这种情况非常罕见（目前博主只发现 Telegram），而且只需额外添加一条静态路由即可解决</p><p></p><div class="tip inlineBlock info">什么？你问我 DNS 是啥玩意？那我建议你<del>关掉本文</del>，或者阅读这篇文章：<a class="link" href="https://draveness.me/dns-coredns/" target="_blank" rel="noopener">详解 DNS 与 CoreDNS 的实现原理</a></div><p></p><h2 id="网络架构">网络架构</h2><p>需要两个额外组件（极简配置下这两个组件合二为一）：</p><ol><li>做透明代理的软路由，可以是主路由也可以是旁路由</li><li>分流 DNS</li></ol><p>原理其实很简单：分流 DNS 劫持 DNS 请求，需要走代理的域名返回透明代理 ip，无需走代理的域名直接返回真实 ip</p><div class="mermaid" style="margin:auto;width:max-content" data-processed="true"><svg aria-roledescription="flowchart-v2" viewBox="-8 -8 467.79296875 491.36737060546875" style="max-width: 467.79296875px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-1673453370068"><style>#mermaid-1673453370068{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1673453370068 .error-icon{fill:#552222;}#mermaid-1673453370068 .error-text{fill:#552222;stroke:#552222;}#mermaid-1673453370068 .edge-thickness-normal{stroke-width:2px;}#mermaid-1673453370068 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1673453370068 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1673453370068 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1673453370068 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1673453370068 .marker{fill:#333333;stroke:#333333;}#mermaid-1673453370068 .marker.cross{stroke:#333333;}#mermaid-1673453370068 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1673453370068 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1673453370068 .cluster-label text{fill:#333;}#mermaid-1673453370068 .cluster-label span{color:#333;}#mermaid-1673453370068 .label text,#mermaid-1673453370068 span{fill:#333;color:#333;}#mermaid-1673453370068 .node rect,#mermaid-1673453370068 .node circle,#mermaid-1673453370068 .node ellipse,#mermaid-1673453370068 .node polygon,#mermaid-1673453370068 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1673453370068 .node .label{text-align:center;}#mermaid-1673453370068 .node.clickable{cursor:pointer;}#mermaid-1673453370068 .arrowheadPath{fill:#333333;}#mermaid-1673453370068 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1673453370068 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1673453370068 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1673453370068 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1673453370068 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1673453370068 .cluster text{fill:#333;}#mermaid-1673453370068 .cluster span{color:#333;}#mermaid-1673453370068 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1673453370068 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-1673453370068 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-UpDNS" id="L-DNS-UpDNS-0" d="M115.62516836041569,279.062243726736L119.60430696701307,272.15557740370906C123.58344557361045,265.2489110806821,131.54172278680522,251.43557843462816,148.32447132795608,235.47575621255336C165.1072198691069,219.51593399047852,190.71443973821377,201.4096221923828,203.51804967276723,192.35646629333496L216.32165960732067,183.3033103942871"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-Proxy" id="L-DNS-Proxy-0" d="M71.37483163958431,279.062243726736L67.39569303298693,272.15557740370906C63.416554426389546,265.2489110806821,55.458277213194776,251.43557843462816,51.47913860659739,237.89609961160122C47.5,224.35662078857422,47.5,211.09099578857422,47.5,204.45818328857422L47.5,197.82537078857422"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-Proxy LE-代理服务器" id="L-Proxy-代理服务器-0" d="M47.5,124.1875L47.5,117.5546875C47.5,110.921875,47.5,97.65625,47.5,84.390625C47.5,71.125,47.5,57.859375,47.5,51.2265625L47.5,44.59375"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UpDNS LE-Internet" id="L-UpDNS-Internet-0" d="M247.85546875,138.7095603942871L247.85546875,129.65640449523926C247.85546875,120.6032485961914,247.85546875,102.4969367980957,247.85546875,86.81096839904785C247.85546875,71.125,247.85546875,57.859375,247.85546875,51.2265625L247.85546875,44.59375"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-Desktop LE-DNS" id="L-Desktop-DNS-0" d="M142,430.7736053466797L142,424.1407928466797C142,417.5079803466797,142,404.2423553466797,137.80460386043538,390.66875953259995C133.60920772087073,377.09516371852015,125.21841544174147,363.21359709036057,121.02301930217685,356.2728137762808L116.8276231626122,349.33203046220103"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-Phone LE-DNS" id="L-Phone-DNS-0" d="M45,430.7736053466797L45,424.1407928466797C45,417.5079803466797,45,404.2423553466797,49.19539613956463,390.66875953259995C53.390792279129265,377.09516371852015,61.78158455825854,363.21359709036057,65.97698069782317,356.2728137762808L70.1723768373878,349.33203046220103"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-BT LE-UpDNS" id="L-BT-UpDNS-0" d="M247.85546875,292.00261306762695L247.85546875,282.93921852111816C247.85546875,273.8758239746094,247.85546875,255.7490348815918,247.85546875,237.63248443603516C247.85546875,219.51593399047852,247.85546875,201.4096221923828,247.85546875,192.35646629333496L247.85546875,183.3033103942871"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-IOT LE-UpDNS" id="L-IOT-UpDNS-0" d="M396.29296875,292.00261306762695L396.29296875,282.93921852111816C396.29296875,273.8758239746094,396.29296875,255.7490348815918,378.7531447652482,237.63248443603516C361.21332078049636,219.51593399047852,326.13367281099266,201.4096221923828,308.59384882624084,192.35646629333496L291.054024841489,183.3033103942871"></path></g><g class="edgeLabels"><g transform="translate(139.5, 237.62224578857422)" class="edgeLabel"><g transform="translate(-32, -14.796875)" class="label"><foreignobject height="29.59375" width="64"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">国内直连</span></div></foreignobject></g></g><g transform="translate(47.5, 237.62224578857422)" class="edgeLabel"><g transform="translate(-40, -14.796875)" class="label"><foreignobject height="29.59375" width="80"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">国外走代理</span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g transform="translate(247.85546875, 84.390625)" class="edgeLabel"><g transform="translate(-40, -14.796875)" class="label"><foreignobject height="29.59375" width="80"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">直接出公网</span></div></foreignobject></g></g><g transform="translate(142, 390.9767303466797)" class="edgeLabel"><g transform="translate(-16, -14.796875)" class="label"><foreignobject height="29.59375" width="32"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">分流</span></div></foreignobject></g></g><g transform="translate(45, 390.9767303466797)" class="edgeLabel"><g transform="translate(-16, -14.796875)" class="label"><foreignobject height="29.59375" width="32"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">分流</span></div></foreignobject></g></g><g transform="translate(247.85546875, 237.62224578857422)" class="edgeLabel"><g transform="translate(-32, -14.796875)" class="label"><foreignobject height="29.59375" width="64"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">全局直连</span></div></foreignobject></g></g><g transform="translate(396.29296875, 237.62224578857422)" class="edgeLabel"><g transform="translate(-32, -14.796875)" class="label"><foreignobject height="29.59375" width="64"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">全局直连</span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(93.5, 314.29948806762695)" id="flowchart-DNS-34" class="node default default"><path transform="translate(-39.7734375,-36.880367475746695)" d="M 0,9.722328317164465 a 39.7734375,9.722328317164465 0,0,0 79.546875 0 a 39.7734375,9.722328317164465 0,0,0 -79.546875 0 l 0,54.31607831716447 a 39.7734375,9.722328317164465 0,0,0 79.546875 0 l 0,-54.31607831716447" style=""></path><g transform="translate(-32.2734375, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="64.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">分流 DNS</span></div></foreignobject></g></g><g transform="translate(247.85546875, 161.0064353942871)" id="flowchart-UpDNS-35" class="node default default"><rect height="44.59375" width="111.546875" y="-22.296875" x="-55.7734375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-48.2734375, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="96.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">上游公共 DNS</span></div></foreignobject></g></g><g transform="translate(47.5, 161.0064353942871)" id="flowchart-Proxy-37" class="node default default"><path transform="translate(-39.5,-36.81893382352941)" d="M 0,9.681372549019608 a 39.5,9.681372549019608 0,0,0 79 0 a 39.5,9.681372549019608 0,0,0 -79 0 l 0,54.275122549019606 a 39.5,9.681372549019608 0,0,0 79 0 l 0,-54.275122549019606" style=""></path><g transform="translate(-32, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="64"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">透明代理</span></div></foreignobject></g></g><g transform="translate(47.5, 22.296875)" id="flowchart-代理服务器-38" class="node default default"><rect height="44.59375" width="95" y="-22.296875" x="-47.5" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-40, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="80"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">代理服务器</span></div></foreignobject></g></g><g transform="translate(247.85546875, 22.296875)" id="flowchart-Internet-40" class="node default default"><rect height="44.59375" width="63" y="-22.296875" x="-31.5" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-24, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="48"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">互联网</span></div></foreignobject></g></g><g transform="translate(142, 453.0704803466797)" id="flowchart-Desktop-43" class="node default default"><rect height="44.59375" width="47" y="-22.296875" x="-23.5" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-16, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="32"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">电脑</span></div></foreignobject></g></g><g transform="translate(45, 453.0704803466797)" id="flowchart-Phone-45" class="node default default"><rect height="44.59375" width="47" y="-22.296875" x="-23.5" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-16, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="32"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">手机</span></div></foreignobject></g></g><g transform="translate(247.85546875, 314.29948806762695)" id="flowchart-BT-47" class="node default default"><rect height="44.59375" width="85.875" y="-22.296875" x="-42.9375" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-35.4375, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="70.875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">BT 下载机</span></div></foreignobject></g></g><g transform="translate(396.29296875, 314.29948806762695)" id="flowchart-IOT-49" class="node default default"><rect height="44.59375" width="111" y="-22.296875" x="-55.5" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-48, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="96"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">智能家居设备</span></div></foreignobject></g></g></g></g></g></svg></div><h2 id="dns-分流配置">DNS 分流配置</h2><h3 id="极简配置">极简配置</h3><p>使用 fake-ip 模式的 Clash 既作为透明代理又作为 DNS Server，这种方式配置非常简单，只需要一个能运行 Clash 的设备即可</p><p>首先你需要部署好 Clash（请自行寻找教程，作为主路由、旁路由都可以，使用虚拟机、docker、lxc 没限制） 然后修改如下配置：</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">dns</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">// 开启 fake-ip 模式</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enhanced-mode</span><span class="p">:</span><span class="w"> </span><span class="l">fake-ip</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">// 选择保留 ip 段，一般保持默认即可</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">fake-ip-range</span><span class="p">:</span><span class="w"> </span><span class="m">198.18.0.1</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">// 指定 Clash DNS 监听地址</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">listen</span><span class="p">:</span><span class="w"> </span><span class="m">0.0.0.0</span><span class="p">:</span><span class="m">53</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">// 指定上游公共 DNS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">nameserver</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="m">223.5.5.5</span><span class="p">:</span><span class="m">53</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">// 添加需要直连的国内域名</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">fake-ip-filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">baidu.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">tun</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stack</span><span class="p">:</span><span class="w"> </span><span class="l">system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">// 自动为 fake-ip-range 中的 ip 段添加路由</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">auto-route</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre><button class="copyCodeButton">Copy</button></div><p>这个配置做了三件事</p><ol><li>开启 dns 服务并指定为 fake-ip 模式，监听 53 端口</li><li>对于 fake-ip-filter 中的国内域名直接返回真实 ip，这些域名的流量不再经过代理</li><li>开启 tun 模式并自动添加路由，将发往 fake-ip 的请求交给 clash 处理</li></ol><p>最关键的是需要将常见国内域名加入到 fake-ip-filter 中，这里推荐一个每日更新国内域名的项目：<a class="link" href="https://github.com/felixonmars/dnsmasq-china-list" target="_blank" rel="noopener">felixonmars/dnsmasq-china-list</a></p><p>你可以自行下载 accelerated-domains.china.conf 文件并为其中的域名加上 <code>+.</code> 前缀然后添加到 fake-ip-filter 中。如果你恰好使用 openclash 可以用博主的脚本，可以自动下载国内域名列表并写入 openclash 的配置文件中</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rm -f accelerated-domains.china.conf
</span></span><span class="line"><span class="cl">wget https://raw.githubusercontent.com/felixonmars/dnsmasq-china-list/master/accelerated-domains.china.conf -O /root/accelerated-domains.china.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">'
</span></span></span><span class="line"><span class="cl"><span class="s1">#LAN
</span></span></span><span class="line"><span class="cl"><span class="s1">*.lan
</span></span></span><span class="line"><span class="cl"><span class="s1">*.localdomain
</span></span></span><span class="line"><span class="cl"><span class="s1">*.example
</span></span></span><span class="line"><span class="cl"><span class="s1">*.invalid
</span></span></span><span class="line"><span class="cl"><span class="s1">*.localhost
</span></span></span><span class="line"><span class="cl"><span class="s1">*.test
</span></span></span><span class="line"><span class="cl"><span class="s1">*.local
</span></span></span><span class="line"><span class="cl"><span class="s1">*.home.arpa
</span></span></span><span class="line"><span class="cl"><span class="s1">#放行NTP服务
</span></span></span><span class="line"><span class="cl"><span class="s1">time.*.com
</span></span></span><span class="line"><span class="cl"><span class="s1">time.*.gov
</span></span></span><span class="line"><span class="cl"><span class="s1">time.*.edu.cn
</span></span></span><span class="line"><span class="cl"><span class="s1">time.*.apple.com
</span></span></span><span class="line"><span class="cl"><span class="s1">ntp.*.com
</span></span></span><span class="line"><span class="cl"><span class="s1">*.time.edu.cn
</span></span></span><span class="line"><span class="cl"><span class="s1">*.ntp.org.cn
</span></span></span><span class="line"><span class="cl"><span class="s1">+.pool.ntp.org
</span></span></span><span class="line"><span class="cl"><span class="s1">time1.cloud.tencent.com
</span></span></span><span class="line"><span class="cl"><span class="s1">*.cn
</span></span></span><span class="line"><span class="cl"><span class="s1">'</span> &gt; /etc/openclash/custom/openclash_custom_fake_filter.list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">awk -F / <span class="s1">'{print "+."$2}'</span> /root/accelerated-domains.china.conf &gt;&gt; /etc/openclash/custom/openclash_custom_fake_filter.list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> fake-ip-filter: &gt; /tmp/openclash_fake_filter.list
</span></span><span class="line"><span class="cl">awk <span class="s1">'{print "  - '</span><span class="se">\'</span><span class="s1">'"$1"'</span><span class="se">\'</span><span class="s1">'"}'</span> /etc/openclash/custom/openclash_custom_fake_filter.list &gt;&gt; /tmp/openclash_fake_filter.list
</span></span></code></pre><button class="copyCodeButton">Copy</button></div><p>看到这里恭喜你全部配置已经完成，是不是很简单？接下来将需要走代理的设备 DNS 改为 Clash DNS 的地址即可享受分流上网</p><p></p><div class="tip inlineBlock info">如果你的 clash 运行在旁路由上，还需要在主路由的路由表中添加一项，将 fake-ip 指向旁路由</div><p></p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># 198.18.0.1/16 是 fake-ip-range 配置的 ip 段</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 192.168.2.254 是旁路由 ip</span>
</span></span><span class="line"><span class="cl">route add -net 198.18.0.1/16 gw 192.168.2.254
</span></span></code></pre><button class="copyCodeButton">Copy</button></div><p></p><div class="tip inlineBlock warning">除非你熟悉 linux 网络配置，否则尽量使用原生 clash 而不是 openclash 之类的周边项目，它们往往会添加 iptables 规则将经过本机的连接都转发到 clash</div><p></p><p>在运行 clash 的服务器上使用 mtr 或 traceroute 来验证分流策略是否生效：如果 mtr 的结果显示无需代理的域名不止一跳并且没有经过 fake-ip-range 的 ip 段则分流配置正确；也可以观察 Clash 控制台，看看是否有无需走代理域名连上来</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># 配置有误</span>
</span></span><span class="line"><span class="cl">root@OpenWrt:~# mtr -r --tcp www.baidu.com
</span></span><span class="line"><span class="cl">Start: 2022-06-09T21:37:36+0800
</span></span><span class="line"><span class="cl">HOST: OpenWrt                              Loss%   Snt   Last   Avg  Best  Wrst StDev
</span></span><span class="line"><span class="cl">  1.<span class="p">|</span>-- 198.18.0.19<span class="o">(</span>fake-ip<span class="o">)</span>                0.0%    <span class="m">10</span>    0.2   0.1   0.1   0.2   0.0
</span></span></code></pre><button class="copyCodeButton">Copy</button></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># 配置正确</span>
</span></span><span class="line"><span class="cl">root@OpenWrt:~# mtr -r --tcp ntp.aliyun.com
</span></span><span class="line"><span class="cl">Start: 2022-06-09T21:40:51+0800
</span></span><span class="line"><span class="cl">HOST: OpenWrt                     Loss%   Snt   Last   Avg  Best  Wrst StDev
</span></span><span class="line"><span class="cl">  1.<span class="p">|</span>-- &lt;主路由 ip&gt;                 0.0%    <span class="m">10</span>    0.1   0.1   0.1   0.2   0.0
</span></span><span class="line"><span class="cl">  2.<span class="p">|</span>-- &lt;公网出口 ip&gt;              10.0%    <span class="m">10</span>    6.0   5.2   3.1   9.5   1.9
</span></span><span class="line"><span class="cl">  3.<span class="p">|</span>-- 117.49.47.202              0.0%    <span class="m">10</span>    4.1   5.0   4.0   6.5   1.0
</span></span><span class="line"><span class="cl">  4.<span class="p">|</span>-- 116.251.94.198             0.0%    <span class="m">10</span>   10.0  11.0  10.0  13.0   1.0
</span></span><span class="line"><span class="cl">  5.<span class="p">|</span>-- ???                       100.0    <span class="m">10</span>    0.0   0.0   0.0   0.0   0.0
</span></span><span class="line"><span class="cl">  6.<span class="p">|</span>-- ???                       100.0    <span class="m">10</span>    0.0   0.0   0.0   0.0   0.0
</span></span><span class="line"><span class="cl">  7.<span class="p">|</span>-- ???                       100.0    <span class="m">10</span>    0.0   0.0   0.0   0.0   0.0
</span></span><span class="line"><span class="cl">  8.<span class="p">|</span>-- 203.107.6.88               0.0%    <span class="m">10</span>   24.7  24.7  24.4  26.2   0.5
</span></span></code></pre><button class="copyCodeButton">Copy</button></div><h3 id="精准分流配置">精准分流配置</h3><p>使用 Clash DNS 的方案虽然配置非常简单，但是毕竟不可能将所有国内域名都统计出来，还需要根据 ip 进行更精准的分流</p><div class="mermaid" style="margin:auto;width:max-content" data-processed="true"><svg aria-roledescription="flowchart-v2" viewBox="-8 -8 358.5546875 279.375" style="max-width: 358.5546875px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-1673453370255"><style>#mermaid-1673453370255{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1673453370255 .error-icon{fill:#552222;}#mermaid-1673453370255 .error-text{fill:#552222;stroke:#552222;}#mermaid-1673453370255 .edge-thickness-normal{stroke-width:2px;}#mermaid-1673453370255 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1673453370255 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1673453370255 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1673453370255 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1673453370255 .marker{fill:#333333;stroke:#333333;}#mermaid-1673453370255 .marker.cross{stroke:#333333;}#mermaid-1673453370255 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1673453370255 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1673453370255 .cluster-label text{fill:#333;}#mermaid-1673453370255 .cluster-label span{color:#333;}#mermaid-1673453370255 .label text,#mermaid-1673453370255 span{fill:#333;color:#333;}#mermaid-1673453370255 .node rect,#mermaid-1673453370255 .node circle,#mermaid-1673453370255 .node ellipse,#mermaid-1673453370255 .node polygon,#mermaid-1673453370255 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1673453370255 .node .label{text-align:center;}#mermaid-1673453370255 .node.clickable{cursor:pointer;}#mermaid-1673453370255 .arrowheadPath{fill:#333333;}#mermaid-1673453370255 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1673453370255 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1673453370255 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1673453370255 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1673453370255 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1673453370255 .cluster text{fill:#333;}#mermaid-1673453370255 .cluster span{color:#333;}#mermaid-1673453370255 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1673453370255 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-1673453370255 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-UpDNS" id="L-DNS-UpDNS-0" d="M89.06227883587066,218.78125L78.40997194655888,212.1484375C67.75766505724711,205.515625,46.45305127862355,192.25,35.800744389311774,175.26822916666666C25.1484375,158.28645833333334,25.1484375,137.58854166666666,25.1484375,119.35677083333333C25.1484375,101.125,25.1484375,85.359375,31.944908153011784,73.30989583333333C38.74137880602357,61.260416666666664,52.33432011204713,52.927083333333336,59.13079076505892,48.760416666666664L65.9272614180707,44.59375"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-UpDNS" id="L-DNS-UpDNS-1" d="M116.76505193916708,218.78125L114.35368911597256,212.1484375C111.94232629277805,205.515625,107.11960064638902,192.25,104.70823782319451,175.26822916666666C102.296875,158.28645833333334,102.296875,137.58854166666666,102.296875,119.35677083333333C102.296875,101.125,102.296875,85.359375,102.296875,73.30989583333333C102.296875,61.260416666666664,102.296875,52.927083333333336,102.296875,48.760416666666664L102.296875,44.59375"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-ClashDNS" id="L-DNS-ClashDNS-0" d="M144.5716227745974,218.78125L150.43208147883115,212.1484375C156.29254018306492,205.515625,168.01345759153244,192.25,179.42768670184321,178.984375C190.84191581215399,165.71875,201.949456624308,152.453125,207.503227030385,145.8203125L213.056997436462,139.1875"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-ClashDNS" id="L-DNS-ClashDNS-1" d="M164.64453125,225.5306379103652L184.490234375,217.77292742530435C204.3359375,210.01521694024345,244.02734375,194.4997959701217,258.31927646892296,180.10927298506087C272.611209187846,165.71875,261.50366837569203,152.453125,255.949897969615,145.8203125L250.396127563538,139.1875"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-ClashDNS LE-UpDNS" id="L-ClashDNS-UpDNS-0" d="M231.7265625,94.59375L231.7265625,90.42708333333333C231.7265625,86.26041666666667,231.7265625,77.92708333333333,219.45052083333334,69.27444115812558C207.17447916666666,60.621798982917845,182.62239583333334,51.6498479658357,170.34635416666666,47.163872457294616L158.0703125,42.67789694875354"></path></g><g class="edgeLabels"><g transform="translate(25.1484375, 116.890625)" class="edgeLabel"><g transform="translate(-25.1484375, -14.796875)" class="label"><foreignobject height="29.59375" width="50.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">国内 ip</span></div></foreignobject></g></g><g transform="translate(102.296875, 116.890625)" class="edgeLabel"><g transform="translate(-32, -14.796875)" class="label"><foreignobject height="29.59375" width="64"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">国内域名</span></div></foreignobject></g></g><g transform="translate(179.734375, 178.984375)" class="edgeLabel"><g transform="translate(-25.1484375, -14.796875)" class="label"><foreignobject height="29.59375" width="50.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">国外 ip</span></div></foreignobject></g></g><g transform="translate(283.71875, 178.984375)" class="edgeLabel"><g transform="translate(-58.8359375, -14.796875)" class="label"><foreignobject height="29.59375" width="117.671875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">GFW 黑名单域名</span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(124.87109375, 241.078125)" id="flowchart-DNS-73" class="node default default"><rect height="44.59375" width="79.546875" y="-22.296875" x="-39.7734375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-32.2734375, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="64.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">分流 DNS</span></div></foreignobject></g></g><g transform="translate(102.296875, 22.296875)" id="flowchart-UpDNS-74" class="node default default"><rect height="44.59375" width="111.546875" y="-22.296875" x="-55.7734375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-48.2734375, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="96.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">上游公共 DNS</span></div></foreignobject></g></g><g transform="translate(231.7265625, 116.890625)" id="flowchart-ClashDNS-78" class="node default default"><rect height="44.59375" width="85.453125" y="-22.296875" x="-42.7265625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-35.2265625, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="70.453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Clash DNS</span></div></foreignobject></g></g></g></g></g></svg></div><p></p><div class="tip inlineBlock info">多数系统不支持指定 DNS 端口，所以分流 DNS 和 Clash DNS 最好分配不同的 ip（可以在单网卡上分配多个内网 ip）</div><p></p><p>博主选用 <a class="link" href="https://github.com/IrineSistiana/mosdns-cn" target="_blank" rel="noopener">IrineSistiana/mosdns-cn</a> 作为分流 DNS，这里引用 mosdns-cn 官方文档上介绍的分流规则</p><blockquote><p>分流模式<br>mosdns-cn 会根据用户提供的数据采用以下分流模式。</p><p>配置了 –local-ip 本地 IP</p><ol><li>如果请求的域名匹配到 –local-domain 本地域名。则直接使用 –local-upstream 本地上游。结束。</li><li>如果请求的域名匹配到 –remote-domain 远程域名。则直接使用–remote-upstream 远程上游。结束。</li><li>非 A/AAAA 类型的请求将直接使用 –local-upstream 本地上游。结束。</li><li>同时转发至本地和远程上游获取应答。</li><li>如果本地上游的应答包含 –local-ip 本地 IP。则直接采用本地上游的结果。结束。</li><li>否则采用远程上游的结果。结束。</li></ol><p>只配置了 –local-domain 本地域名</p><ol><li>如果请求的域名匹配到 –local-domain 本地域名。则直接使用 –local-upstream 本地上游。结束。</li><li>其他所有请求会使用 –remote-upstream 远程上游。结束。</li></ol><p>只配置了 –remote-domain 远程域名</p><ol><li>如果请求的域名匹配到 –remote-domain 远程域名。则直接使用–remote-upstream 远程上游。结束。</li><li>其他所有请求会使用 –local-upstream 本地上游。结束。</li></ol></blockquote><p>Github 上有详细使用教程，这里给出博主使用的启动脚本，每次启动时拉取最新的国内外域名/ip 数据</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">RELEASE_URL</span><span class="o">=</span><span class="k">$(</span>curl -s https://api.github.com/repos/Loyalsoldier/v2ray-rules-dat/releases/latest <span class="p">|</span> grep browser_download_url<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">GEOSITE_URL</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$RELEASE_URL</span><span class="s2">"</span> <span class="p">|</span> grep geosite.dat<span class="se">\"</span> <span class="p">|</span> cut -d<span class="s1">'"'</span> -f4<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">GEOIP_URL</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$RELEASE_URL</span><span class="s2">"</span> <span class="p">|</span> grep geoip.dat<span class="se">\"</span> <span class="p">|</span> cut -d<span class="s1">'"'</span> -f4<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -z <span class="nv">$GEOSITE_URL</span> <span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">"GEOSITE_URL required!"</span>
</span></span><span class="line"><span class="cl">  <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -z <span class="nv">$GEOIP_URL</span> <span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">"GEOIP_URL required!"</span>
</span></span><span class="line"><span class="cl">  <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$GEOSITE_URL</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$GEOIP_URL</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wget <span class="nv">$GEOSITE_URL</span> -O geosite.dat
</span></span><span class="line"><span class="cl">wget <span class="nv">$GEOIP_URL</span> -O geoip.dat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mosdns-cn -s :53 --blacklist-domain <span class="s2">"geosite.dat:category-ads-all"</span> --local-upstream 223.5.5.5:53 --local-domain <span class="s2">"geosite.dat:cn"</span> --local-ip <span class="s2">"geoip.dat:cn"</span> --remote-upstream https://8.8.8.8/dns-query --remote-domain <span class="s2">"geosite.dat:geolocation-!cn"</span>
</span></span></code></pre><button class="copyCodeButton">Copy</button></div><h3 id="去广告dns-解析统计配置">去广告/DNS 解析统计配置</h3><p>mos-dns 支持配置黑名单域名直接给出空响应，可以使用这一机制阻断广告域名的访问：<code>mosdns-cn --blacklist-domain "geosite.dat:category-ads-all"</code></p><p>但是目前少有大佬分享适配 mosdns-cn 的去广告规则，这种专业的事情还是交给 Adguard Home 来做：</p><div class="mermaid" style="margin:auto;width:max-content" data-processed="true"><svg aria-roledescription="flowchart-v2" viewBox="-8 -8 358.5546875 373.96875" style="max-width: 358.5546875px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-1673453370305"><style>#mermaid-1673453370305{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1673453370305 .error-icon{fill:#552222;}#mermaid-1673453370305 .error-text{fill:#552222;stroke:#552222;}#mermaid-1673453370305 .edge-thickness-normal{stroke-width:2px;}#mermaid-1673453370305 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1673453370305 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1673453370305 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1673453370305 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1673453370305 .marker{fill:#333333;stroke:#333333;}#mermaid-1673453370305 .marker.cross{stroke:#333333;}#mermaid-1673453370305 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1673453370305 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1673453370305 .cluster-label text{fill:#333;}#mermaid-1673453370305 .cluster-label span{color:#333;}#mermaid-1673453370305 .label text,#mermaid-1673453370305 span{fill:#333;color:#333;}#mermaid-1673453370305 .node rect,#mermaid-1673453370305 .node circle,#mermaid-1673453370305 .node ellipse,#mermaid-1673453370305 .node polygon,#mermaid-1673453370305 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1673453370305 .node .label{text-align:center;}#mermaid-1673453370305 .node.clickable{cursor:pointer;}#mermaid-1673453370305 .arrowheadPath{fill:#333333;}#mermaid-1673453370305 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1673453370305 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1673453370305 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1673453370305 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1673453370305 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1673453370305 .cluster text{fill:#333;}#mermaid-1673453370305 .cluster span{color:#333;}#mermaid-1673453370305 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1673453370305 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-1673453370305 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-AdguardHome" id="L-DNS-AdguardHome-0" d="M89.06227883587066,313.375L78.40997194655888,306.7421875C67.75766505724711,300.109375,46.45305127862355,286.84375,35.800744389311774,269.8619791666667C25.1484375,252.88020833333334,25.1484375,232.18229166666666,25.1484375,213.95052083333334C25.1484375,195.71875,25.1484375,179.953125,31.944908153011784,167.90364583333334C38.74137880602357,155.85416666666666,52.33432011204713,147.52083333333334,59.13079076505892,143.35416666666666L65.9272614180707,139.1875"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-AdguardHome" id="L-DNS-AdguardHome-1" d="M116.76505193916708,313.375L114.35368911597256,306.7421875C111.94232629277805,300.109375,107.11960064638902,286.84375,104.70823782319451,269.8619791666667C102.296875,252.88020833333334,102.296875,232.18229166666666,102.296875,213.95052083333334C102.296875,195.71875,102.296875,179.953125,102.296875,167.90364583333334C102.296875,155.85416666666666,102.296875,147.52083333333334,102.296875,143.35416666666666L102.296875,139.1875"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-ClashDNS" id="L-DNS-ClashDNS-0" d="M144.5716227745974,313.375L150.43208147883115,306.7421875C156.29254018306492,300.109375,168.01345759153244,286.84375,179.42768670184321,273.578125C190.84191581215399,260.3125,201.949456624308,247.046875,207.503227030385,240.4140625L213.056997436462,233.78125"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DNS LE-ClashDNS" id="L-DNS-ClashDNS-1" d="M164.64453125,320.12438791036516L184.490234375,312.3666774253043C204.3359375,304.6089669402434,244.02734375,289.09354597012174,258.31927646892296,274.70302298506084C272.611209187846,260.3125,261.50366837569203,247.046875,255.949897969615,240.4140625L250.396127563538,233.78125"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-ClashDNS LE-AdguardHome" id="L-ClashDNS-AdguardHome-0" d="M231.7265625,189.1875L231.7265625,185.02083333333334C231.7265625,180.85416666666666,231.7265625,172.52083333333334,220.1171875,164.11180798676082C208.5078125,155.7027826401883,185.2890625,147.21806528037663,173.6796875,142.9757066004708L162.0703125,138.73334792056497"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-AdguardHome LE-UpDNS" id="L-AdguardHome-UpDNS-0" d="M102.296875,94.59375L102.296875,90.42708333333333C102.296875,86.26041666666667,102.296875,77.92708333333333,102.296875,69.59375C102.296875,61.260416666666664,102.296875,52.927083333333336,102.296875,48.760416666666664L102.296875,44.59375"></path></g><g class="edgeLabels"><g transform="translate(25.1484375, 211.484375)" class="edgeLabel"><g transform="translate(-25.1484375, -14.796875)" class="label"><foreignobject height="29.59375" width="50.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">国内 ip</span></div></foreignobject></g></g><g transform="translate(102.296875, 211.484375)" class="edgeLabel"><g transform="translate(-32, -14.796875)" class="label"><foreignobject height="29.59375" width="64"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">国内域名</span></div></foreignobject></g></g><g transform="translate(179.734375, 273.578125)" class="edgeLabel"><g transform="translate(-25.1484375, -14.796875)" class="label"><foreignobject height="29.59375" width="50.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">国外 ip</span></div></foreignobject></g></g><g transform="translate(283.71875, 273.578125)" class="edgeLabel"><g transform="translate(-58.8359375, -14.796875)" class="label"><foreignobject height="29.59375" width="117.671875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">GFW 黑名单域名</span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignobject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g transform="translate(124.87109375, 335.671875)" id="flowchart-DNS-110" class="node default default"><rect height="44.59375" width="79.546875" y="-22.296875" x="-39.7734375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-32.2734375, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="64.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">分流 DNS</span></div></foreignobject></g></g><g transform="translate(102.296875, 116.890625)" id="flowchart-AdguardHome-111" class="node default default"><rect height="44.59375" width="119.546875" y="-22.296875" x="-59.7734375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-52.2734375, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="104.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Adguard Home</span></div></foreignobject></g></g><g transform="translate(231.7265625, 211.484375)" id="flowchart-ClashDNS-115" class="node default default"><rect height="44.59375" width="85.453125" y="-22.296875" x="-42.7265625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-35.2265625, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="70.453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Clash DNS</span></div></foreignobject></g></g><g transform="translate(102.296875, 22.296875)" id="flowchart-UpDNS-121" class="node default default"><rect height="44.59375" width="111.546875" y="-22.296875" x="-55.7734375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-48.2734375, -14.796875)" style="" class="label"><foreignobject height="29.59375" width="96.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">上游公共 DNS</span></div></foreignobject></g></g></g></g></g></svg></div><p>将 Adguard Home 放在 mosdns-cn 和 Clash DNS 的上游还有其他好处，可以借助它的仪表盘和日志分析出整个网络访问的网站</p><p></p><div class="gallery"><figure class="gallery-image" style="flex-grow:112;flex-basis:270px"><a href="./post_files/adguard-home.jpg" data-size="1217x1078"><img src="./post_files/adguard-home.jpg" width="1217" height="1078" loading="lazy" alt="Adguard Home 仪表盘"></a><figcaption>Adguard Home 仪表盘</figcaption></figure></div><p></p><p>Adguard Home 的部署教程网上有很多，能看到这里的人肯定也不用我赘述了。这里推荐一个博主自用的过滤规则，有了它就不需要其他规则了：<a class="link" href="https://github.com/BlueSkyXN/AdGuardHomeRules" target="_blank" rel="noopener">BlueSkyXN/AdGuardHomeRules</a></p><h2 id="其他配置">其他配置</h2><h3 id="自动设置设备的-dns-服务器">自动设置设备的 DNS 服务器</h3><p>在<code>极简配置</code>中博主提到<code>将需要走代理的设备 DNS 改为分流 DNS</code>，这一步可以手动改也可以借助 DHCP 自动配置：DHCP Option 6 的作用就是指定客户端使用的 DNS，在 Openwrt LAN 接口的高级设置中即可找到该设置</p><p></p><div class="gallery"><figure class="gallery-image" style="flex-grow:254;flex-basis:610px"><a href="./post_files/openwrt-dhcp-option.jpg" data-size="1134x446"><img src="./post_files/openwrt-dhcp-option.jpg" width="1134" height="446" loading="lazy" alt="Openwrt DHCP Option 配置"></a><figcaption>Openwrt DHCP Option 配置</figcaption></figure></div><p></p><h3 id="为直接使用-ip-的-app-设置路由">为直接使用 IP 的 APP 设置路由</h3><p>直接使用 ip 的软件没有经过 DNS 自然就无法获取到 Clash 的 fake-ip，对于这种情况需要在主路由上添加静态路由将这些软件使用的 ip 的下一跳路由改为 Clash 的 fake-ip</p><p>目前我只发现 Telegram 存在这种情况，需要添加的路由如下：</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># 192.18.1.254 是 fake-ip，可以从 fake-ip-range 中随便选择一个</span>
</span></span><span class="line"><span class="cl">route add -net 91.108.4.0/22 gw 192.18.1.254
</span></span><span class="line"><span class="cl">route add -net 91.108.8.0/22 gw 192.18.1.254
</span></span><span class="line"><span class="cl">route add -net 91.108.12.0/22 gw 192.18.1.254
</span></span><span class="line"><span class="cl">route add -net 91.108.16.0/22 gw 192.18.1.254
</span></span><span class="line"><span class="cl">route add -net 91.108.56.0/22 gw 192.18.1.254
</span></span><span class="line"><span class="cl">route add -net 149.154.160.0/20 gw 192.18.1.254
</span></span></code></pre><button class="copyCodeButton">Copy</button></div></section><footer class="article-footer"><section class="article-tags"><a href="https://blog.lv5.moe/tags/dns">DNS</a>
<a href="https://blog.lv5.moe/tags/pbr">PBR</a>
<a href="https://blog.lv5.moe/tags/clash">Clash</a>
<a href="https://blog.lv5.moe/tags/mosdns">MosDNS</a>
<a href="https://blog.lv5.moe/tags/%E7%AD%96%E7%95%A5%E8%B7%AF%E7%94%B1">策略路由</a></section><section class="article-copyright"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="12" cy="12" r="9"></circle><path d="M14.5 9a3.5 4 0 100 6"></path></svg><span>Licensed under <a class="link" href="https://creativecommons.org/licenses/by-nc-sa/4.0" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a><br>转载或引用本文时请遵守许可协议，知会作者并注明出处<br>不得用于商业用途！</span></section><section class="article-lastmod"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="12" cy="12" r="9"></circle><polyline points="12 7 12 12 15 15"></polyline></svg><span>Last updated on Sep 02, 2022 02:13</span></section></footer></article><aside class="related-contents--wrapper"><h2 class="section-title">Related contents</h2><div class="related-contents"><div class="flex article-list--tile"><article class="has-image"><a href="https://blog.lv5.moe/p/pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial"><div class="article-image"><img src="./post_files/hackintosh-logo.304471f6138035f5e599b35c0d5fb2b0_hub84d57ef7ab3db3da54d75c605201e6c_22664_250x150_fill_box_smart1_3.png" width="250" height="150" loading="lazy" data-key="pve-virtualized-hackintosh-gpu-passthrough-and-remote-access-tutorial" data-hash="md5-MERx9hOANfXlmbNcDV+ysA=="></div><div class="article-details" style="background: linear-gradient(0deg, rgba(3, 107, 150, 0.5) 0%, rgba(244, 132, 28, 0.75) 100%);"><h2 class="article-title">PVE 虚拟化黑苹果显卡直通及远程访问教程</h2></div></a></article><article class="has-image"><a href="https://blog.lv5.moe/p/website-hosting-and-function-computing-service-selection"><div class="article-image"><img src="./post_files/cover.svg" loading="lazy" data-key="website-hosting-and-function-computing-service-selection" data-hash="/p/website-hosting-and-function-computing-service-selection/cover.svg"></div><div class="article-details"><h2 class="article-title">Cloudflare or Vercel —— 网站托管与函数计算服务选择</h2></div></a></article><article class="has-image"><a href="https://blog.lv5.moe/p/selection-and-migration-from-typecho-to-hugo"><div class="article-image"><img src="./post_files/90724581_p0.41fbad51307cdde4395ccd0c1cc65eb3_hud5cb26b8501d7cbb0a5bfb5e8c414bee_103329_250x150_fill_q75_box_smart1.jpg" width="250" height="150" loading="lazy" data-key="selection-and-migration-from-typecho-to-hugo" data-hash="md5-QfutUTB83eQ5XM0MHMZesw=="></div><div class="article-details" style="background: linear-gradient(0deg, rgba(77, 44, 52, 0.5) 0%, rgba(173, 82, 100, 0.75) 100%);"><h2 class="article-title">从 Typecho 到 Hugo 的选择与迁移</h2></div></a></article><article class="has-image"><a href="https://blog.lv5.moe/p/nginx-ssl-tls-configuration-optimization"><div class="article-image"><img src="./post_files/ssl-logo.dcc1d89a79f4e18c05f875ef1d4c47e7_hu0d352a211a34cc70a94a1106767ca9fd_19549_250x150_fill_q75_box_smart1.jpg" width="250" height="150" loading="lazy" data-key="nginx-ssl-tls-configuration-optimization" data-hash="md5-3MHYmnn04YwF+HXvHUxH5w=="></div><div class="article-details" style="background: linear-gradient(0deg, rgba(68, 148, 108, 0.5) 0%, rgba(4, 172, 92, 0.75) 100%);"><h2 class="article-title">Nginx SSL/TLS 配置优化</h2></div></a></article><article class="has-image"><a href="https://blog.lv5.moe/p/deluge-modify-user-agent-and-peer-id-tutorials"><div class="article-image"><img src="./post_files/deluge-logo.da65f5c515641d892af10ab163731505_hud927fadcfecc8c2fd76c8e1fda8fa111_26133_250x150_fill_q75_box_smart1.jpg" width="250" height="150" loading="lazy" data-key="deluge-modify-user-agent-and-peer-id-tutorials" data-hash="md5-2mX1xRVkHYkq8QqxY3MVBQ=="></div><div class="article-details" style="background: linear-gradient(0deg, rgba(52, 68, 99, 0.5) 0%, rgba(113, 148, 196, 0.75) 100%);"><h2 class="article-title">Deluge 2.0.3 修改 user-agent 和 peer-id 教程</h2></div></a></article></div></div></aside><script async="" defer="" src="./post_files/Waline.min.js.下载"></script><div id="waline" class="waline-container" data-v-app=""><div class="v" data-class="v"><div class="vcomment"><!--v-if--><div class="vpanel"><div class="vheader vheader-3"><div class="vheader-item"><label for="nick">昵称</label><input id="waline-nick" class="vinput vnick" name="nick" type="text"></div><div class="vheader-item"><label for="mail">邮箱</label><input id="waline-mail" class="vinput vmail" name="mail" type="email"></div><div class="vheader-item"><label for="link">网址(可选)</label><input id="waline-link" class="vinput vlink" name="link" type="text"></div></div><textarea class="veditor" id="waline-edit" placeholder="欢迎评论" data-gramm="false" wt-ignore-input="true"></textarea><div class="vpreview" style="display: none;"><h4>预览:</h4><div class="vcontent"></div></div><div class="vfooter"><div class="vactions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="vaction" target="_blank" rel="noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button class="vaction" title="表情"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><input class="upload" id="waline-image-upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="waline-image-upload" class="vaction" title="上传图片"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button class="vaction" title="预览"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="vinfo"><div class="vtext-number">0 <!--v-if--> &nbsp;字</div><button class="vbtn">登录</button><button class="vbtn primary" title="Cmd|Ctrl + Enter">提交</button></div><div class="vemoji-popup"><div class="vtab-wrapper"><button title="qq_smile"><!--v-if--></button><button title="qq_mouth_squirm"><!--v-if--></button><button title="qq_heart_eyes"><!--v-if--></button><button title="qq_flushed"><!--v-if--></button><button title="qq_sunglasses"><!--v-if--></button><button title="qq_sob"><!--v-if--></button><button title="qq_shy"><!--v-if--></button><button title="qq_silent"><!--v-if--></button><button title="qq_sleep"><!--v-if--></button><button title="qq_cry"><!--v-if--></button><button title="qq_awkward"><!--v-if--></button><button title="qq_rage"><!--v-if--></button><button title="qq_yum"><!--v-if--></button><button title="qq_grin"><!--v-if--></button><button title="qq_confounded"><!--v-if--></button><button title="qq_sad"><!--v-if--></button><button title="qq_cool"><!--v-if--></button><button title="qq_cold_sweat"><!--v-if--></button><button title="qq_crazy"><!--v-if--></button><button title="qq_vomit"><!--v-if--></button><button title="qq_chuckle"><!--v-if--></button><button title="qq_lovely"><!--v-if--></button><button title="qq_rolling_eyes"><!--v-if--></button><button title="qq_arrogant"><!--v-if--></button><button title="qq_yummy"><!--v-if--></button><button title="qq_sleepy"><!--v-if--></button><button title="qq_scared"><!--v-if--></button><button title="qq_sweat"><!--v-if--></button><button title="qq_laugh"><!--v-if--></button><button title="qq_solder"><!--v-if--></button><button title="qq_fighting"><!--v-if--></button><button title="qq_scold"><!--v-if--></button><button title="qq_shush"><!--v-if--></button><button title="qq_dizzy_face"><!--v-if--></button><button title="qq_mad"><!--v-if--></button><button title="qq_feeble"><!--v-if--></button><button title="qq_skull"><!--v-if--></button><button title="qq_knock"><!--v-if--></button><button title="qq_bye"><!--v-if--></button><button title="qq_pick_nose"><!--v-if--></button><button title="qq_clap"><!--v-if--></button><button title="qq_embarassed"><!--v-if--></button><button title="qq_snigger"><!--v-if--></button><button title="qq_annoyed_left"><!--v-if--></button><button title="qq_annoyed_right"><!--v-if--></button><button title="qq_yawn"><!--v-if--></button><button title="qq_look_down"><!--v-if--></button><button title="qq_grievance"><!--v-if--></button><button title="qq_pensive"><!--v-if--></button><button title="qq_smirk"><!--v-if--></button><button title="qq_kiss_right"><!--v-if--></button><button title="qq_kiss"><!--v-if--></button><button title="qq_fearful"><!--v-if--></button><button title="qq_poor"><!--v-if--></button><button title="qq_wink"><!--v-if--></button><button title="qq_joy"><!--v-if--></button><button title="qq_doge"><!--v-if--></button><button title="qq_cover_face_cry"><!--v-if--></button><button title="qq_whatever"><!--v-if--></button><button title="qq_lift_check"><!--v-if--></button><button title="qq_cute"><!--v-if--></button><button title="qq_antic"><!--v-if--></button><button title="qq_vomit_blood"><!--v-if--></button><button title="qq_surprised"><!--v-if--></button><button title="qq_pock_face"><!--v-if--></button><button title="qq_tangled"><!--v-if--></button><button title="qq_pretty"><!--v-if--></button><button title="qq_mask_fighting"><!--v-if--></button><button title="qq_mask_hug"><!--v-if--></button><button title="qq_mask"><!--v-if--></button><button title="qq_working"><!--v-if--></button><button title="qq_busy"><!--v-if--></button><button title="qq_headache"><!--v-if--></button><button title="qq_worry"><!--v-if--></button><button title="qq_cover_face"><!--v-if--></button><button title="qq_burning_eyes"><!--v-if--></button><button title="qq_wowyo"><!--v-if--></button><button title="qq_hair_loss"><!--v-if--></button><button title="qq_question_mask"><!--v-if--></button><button title="qq_peep"><!--v-if--></button><button title="qq_emm"><!--v-if--></button><button title="qq_waterlemon_face"><!--v-if--></button><button title="qq_rolling_face"><!--v-if--></button><button title="qq_hug"><!--v-if--></button><button title="qq_doubt"><!--v-if--></button><button title="qq_sweat1"><!--v-if--></button><button title="qq_white-yum"><!--v-if--></button><button title="qq_white1"><!--v-if--></button><button title="qq_white2"><!--v-if--></button><button title="qq_white_kiss"><!--v-if--></button><button title="qq_white_shit"><!--v-if--></button><button title="qq_white_slap"><!--v-if--></button><button title="qq_white_sunglasses"><!--v-if--></button><button title="qq_white_thumbsup"><!--v-if--></button><button title="qq_bear1"><!--v-if--></button><button title="qq_bear2"><!--v-if--></button><button title="qq_bear3"><!--v-if--></button><button title="qq_bear4"><!--v-if--></button><button title="qq_bear5"><!--v-if--></button><button title="qq_bird1"><!--v-if--></button><button title="qq_bird2"><!--v-if--></button><button title="qq_bird3"><!--v-if--></button><button title="qq_bird4"><!--v-if--></button><button title="qq_heart"><!--v-if--></button><button title="qq_rose"><!--v-if--></button><button title="qq_rose_dead"><!--v-if--></button><button title="qq_ghost"><!--v-if--></button><button title="qq_anger"><!--v-if--></button><button title="qq_lip"><!--v-if--></button><button title="qq_broken_heart"><!--v-if--></button><button title="qq_coffee"><!--v-if--></button><button title="qq_alpaca"><!--v-if--></button><button title="qq_hongbao"><!--v-if--></button><button title="qq_firecracker"><!--v-if--></button><button title="qq_lantern"><!--v-if--></button><button title="qq_xi"><!--v-if--></button><button title="qq_thumbsup"><!--v-if--></button><button title="qq_ok"><!--v-if--></button><button title="qq_hold_fist"><!--v-if--></button><button title="qq_hand_shake"><!--v-if--></button><button title="qq_come"><!--v-if--></button><button title="qq_v"><!--v-if--></button><button title="qq_fist"><!--v-if--></button><button title="qq_diss"><!--v-if--></button><button title="qq_thumbsdown"><!--v-if--></button><button title="qq_metal"><!--v-if--></button><button title="qq_no"><!--v-if--></button><button title="qq_lemon_face"><!--v-if--></button><button title="qq_moon"><!--v-if--></button><button title="qq_sun"><!--v-if--></button><button title="qq_pig"><!--v-if--></button><button title="qq_knife"><!--v-if--></button><button title="qq_hocho"><!--v-if--></button><button title="qq_gun"><!--v-if--></button><button title="qq_tea"><!--v-if--></button><button title="qq_shit"><!--v-if--></button><button title="qq_tada"><!--v-if--></button><button title="qq_candy"><!--v-if--></button><button title="qq_watermelon"><!--v-if--></button><button title="qq_rice"><!--v-if--></button><button title="qq_feeding_bottle"><!--v-if--></button><button title="qq_beer"><!--v-if--></button><button title="qq_karaoke"><!--v-if--></button><button title="qq_cake"><!--v-if--></button><button title="qq_egg"><!--v-if--></button><button title="qq_bomb"><!--v-if--></button><button title="qq_dollar"><!--v-if--></button><button title="qq_light"><!--v-if--></button><button title="qq_gift"><!--v-if--></button><button title="qq_flower"><!--v-if--></button><button title="qq_plane"><!--v-if--></button><button title="qq_candle"><!--v-if--></button><button title="qq_ladybug"><!--v-if--></button><button title="qq_pill"><!--v-if--></button><button title="qq_basketball"><!--v-if--></button><button title="qq_pingpong"><!--v-if--></button><button title="qq_soccer"><!--v-if--></button><button title="qq_panda"><!--v-if--></button><button title="qq_pinwheel"><!--v-if--></button><button title="qq_ramen"><!--v-if--></button><button title="qq_umbrella"><!--v-if--></button><button title="qq_banana"><!--v-if--></button><button title="qq_toilet_paper"><!--v-if--></button><button title="qq_bag"><!--v-if--></button><button title="qq_fa"><!--v-if--></button><button title="qq_handsome"><!--v-if--></button><button title="qq_mail"><!--v-if--></button><button title="qq_balloon"><!--v-if--></button><button title="qq_board"><!--v-if--></button><button title="qq_bow"><!--v-if--></button><button title="qq_boy1"><!--v-if--></button><button title="qq_boy2"><!--v-if--></button><button title="qq_bulb"><!--v-if--></button><button title="qq_car"><!--v-if--></button><button title="qq_clock"><!--v-if--></button><button title="qq_cloudy"><!--v-if--></button><button title="qq_crab"><!--v-if--></button><button title="qq_example"><!--v-if--></button><button title="qq_frog"><!--v-if--></button><button title="qq_rain"><!--v-if--></button><button title="qq_ring"><!--v-if--></button><button title="qq_sofa"><!--v-if--></button><button title="qq_train_body"><!--v-if--></button><button title="qq_train_tail"><!--v-if--></button><button title="qq_tran_head"><!--v-if--></button><button title="qq_1"><!--v-if--></button><button title="qq_10"><!--v-if--></button><button title="qq_11"><!--v-if--></button><button title="qq_2"><!--v-if--></button><button title="qq_3"><!--v-if--></button><button title="qq_4"><!--v-if--></button><button title="qq_5"><!--v-if--></button><button title="qq_6"><!--v-if--></button><button title="qq_7"><!--v-if--></button><button title="qq_8"><!--v-if--></button><button title="qq_9"><!--v-if--></button><button title="qq_surrender"><!--v-if--></button><button title="qq_taiji_boy"><!--v-if--></button><button title="qq_taiji_girl"><!--v-if--></button></div><!--v-if--><div class="vtabs"><button class="vtab active"><img class="vemoji" src="https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/qq/qq_grin.gif" alt="qq" title="qq" loading="lazy" referrerpolicy="no-referrer"></button><button class="vtab"><img class="vemoji" src="https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji/1f603.png" alt="twemoji" title="twemoji" loading="lazy" referrerpolicy="no-referrer"></button></div></div></div></div><!--v-if--></div><div class="vcount"><span class="vnum">20</span> 评论</div><div class="vcards"><div class="vitem" id="638d94ed75600f0008c33ca7"><img class="vuser" aria-hidden="true" src="./post_files/9df58e7e2323d49959cf421a5e7313d7"><div class="vcard"><div class="vhead"><span class="vnick">ttt<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-12-05</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome108.0</span><span>Mac OS 10.15.7</span></div><div class="vcontent"><p>adg 不能显示 客户端ip 这个怎么处理</p>
</div><!--v-if--><div class="vquote"><div class="vitem" id="638dea0cc695be0008b6a7ac"><img class="vuser" aria-hidden="true" src="./post_files/32436597"><div class="vcard"><div class="vhead"><a class="vnick" href="https://blog.lv5.moe/" target="_blank" rel="nofollow noreferrer">SSpirits<svg class="verified-icon" viewBox="0 0 1024 1024" width="14" height="14"><path d="M512 44.608l388.352 109.696a38.016 38.016 0 0 1 27.648 36.608v337.984c-1.984 110.528-40.192 207.04-113.984 288-73.92 81.024-172.48 134.528-294.592 160.32l-8.192 1.728-8.192-2.048c-127.616-32.832-225.536-85.952-293.056-160-68.096-74.688-105.984-171.584-113.92-289.28L96 526.336V190.976c0-17.024 11.328-32 27.648-36.608L512 44.608z m0 74.816L168 216.64v307.328l0.128 1.856c7.232 99.712 38.4 179.52 93.44 240.704l1.664 1.92c55.488 60.8 137.728 106.304 247.488 136l2.048 0.512 1.408-0.32c102.272-23.232 183.552-67.968 244.736-134.144l1.92-2.112c62.592-68.672 94.08-149.376 95.168-243.584V216.64L512 119.36z m222.592 229.888a32 32 0 0 1 0.448 44.864l-0.384 0.384-244.8 246.016a32 32 0 0 1-44.992 0.384l-0.384-0.384-155.136-155.968a32 32 0 0 1 44.992-45.504L467.2 572.608 689.28 349.44a32 32 0 0 1 45.312-0.128z" fill="#27ae60"></path></svg></a><span class="vbadge">博主</span><!--v-if--><span class="vtime">2022-12-05</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome107.0</span><span>Mac OS 10.15.7</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#638d94ed75600f0008c33ca7" xlink:show="new">@ttt</a>: 这个没什么好办法，你可以通过 mosdns 来统计各个客户端的 dns 请求</p>
</div><!--v-if--><!--v-if--></div></div><div class="vitem" id="639052d898602e00084391b5"><img class="vuser" aria-hidden="true" src="./post_files/9df58e7e2323d49959cf421a5e7313d7"><div class="vcard"><div class="vhead"><span class="vnick">ttt<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-12-07</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome108.0</span><span>Mac OS 10.15.7</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#638dea0cc695be0008b6a7ac" xlink:show="new">@SSpirits</a>: 感谢回复，找到一个不是太完美的办法，我主路由是ros，可以用 netmap 映射，不过我是把 adg 放在最底层，往上层是国外到 clash和国内到公共dns，这样adg里面 就可以查看了，不过ip显示的不再是 <a href="http://192.168.1.xxx/" target="_blank" rel="noreferrer noopener">192.168.1.xxx</a> 而变成了 <a href="http://10.168.1.xxx/" target="_blank" rel="noreferrer noopener">10.168.1.xxx</a></p>
</div><!--v-if--><!--v-if--></div></div><div class="vitem" id="639053aa98602e00084391b6"><img class="vuser" aria-hidden="true" src="./post_files/32436597"><div class="vcard"><div class="vhead"><a class="vnick" href="https://blog.lv5.moe/" target="_blank" rel="nofollow noreferrer">SSpirits<svg class="verified-icon" viewBox="0 0 1024 1024" width="14" height="14"><path d="M512 44.608l388.352 109.696a38.016 38.016 0 0 1 27.648 36.608v337.984c-1.984 110.528-40.192 207.04-113.984 288-73.92 81.024-172.48 134.528-294.592 160.32l-8.192 1.728-8.192-2.048c-127.616-32.832-225.536-85.952-293.056-160-68.096-74.688-105.984-171.584-113.92-289.28L96 526.336V190.976c0-17.024 11.328-32 27.648-36.608L512 44.608z m0 74.816L168 216.64v307.328l0.128 1.856c7.232 99.712 38.4 179.52 93.44 240.704l1.664 1.92c55.488 60.8 137.728 106.304 247.488 136l2.048 0.512 1.408-0.32c102.272-23.232 183.552-67.968 244.736-134.144l1.92-2.112c62.592-68.672 94.08-149.376 95.168-243.584V216.64L512 119.36z m222.592 229.888a32 32 0 0 1 0.448 44.864l-0.384 0.384-244.8 246.016a32 32 0 0 1-44.992 0.384l-0.384-0.384-155.136-155.968a32 32 0 0 1 44.992-45.504L467.2 572.608 689.28 349.44a32 32 0 0 1 45.312-0.128z" fill="#27ae60"></path></svg></a><span class="vbadge">博主</span><!--v-if--><span class="vtime">2022-12-07</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome107.0</span><span>Mac OS 10.15.7</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#639052d898602e00084391b5" xlink:show="new">@ttt</a>: 不嫌麻烦的话在分流 DNS 之前再加一个 adguard 来统计客户端请求也不失为一个好办法。。。</p>
</div><!--v-if--><!--v-if--></div></div></div></div></div><div class="vitem" id="638862c5dbcffd000873c233"><img class="vuser" aria-hidden="true" src="./post_files/g"><div class="vcard"><div class="vhead"><span class="vnick">czp<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-12-01</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Edge107.0</span><span>Windows 10</span></div><div class="vcontent"><p>你好 我用的是ros路由器 应该怎么添加这个tg的IP 我在路由表里面设置好像是无效的<br>
<img alt="QQ图片20221201161530.png" src="data:image/png;base64,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"></p>
</div><!--v-if--><div class="vquote"><div class="vitem" id="638de9dec695be0008b6a7ab"><img class="vuser" aria-hidden="true" src="./post_files/32436597"><div class="vcard"><div class="vhead"><a class="vnick" href="https://blog.lv5.moe/" target="_blank" rel="nofollow noreferrer">SSpirits<svg class="verified-icon" viewBox="0 0 1024 1024" width="14" height="14"><path d="M512 44.608l388.352 109.696a38.016 38.016 0 0 1 27.648 36.608v337.984c-1.984 110.528-40.192 207.04-113.984 288-73.92 81.024-172.48 134.528-294.592 160.32l-8.192 1.728-8.192-2.048c-127.616-32.832-225.536-85.952-293.056-160-68.096-74.688-105.984-171.584-113.92-289.28L96 526.336V190.976c0-17.024 11.328-32 27.648-36.608L512 44.608z m0 74.816L168 216.64v307.328l0.128 1.856c7.232 99.712 38.4 179.52 93.44 240.704l1.664 1.92c55.488 60.8 137.728 106.304 247.488 136l2.048 0.512 1.408-0.32c102.272-23.232 183.552-67.968 244.736-134.144l1.92-2.112c62.592-68.672 94.08-149.376 95.168-243.584V216.64L512 119.36z m222.592 229.888a32 32 0 0 1 0.448 44.864l-0.384 0.384-244.8 246.016a32 32 0 0 1-44.992 0.384l-0.384-0.384-155.136-155.968a32 32 0 0 1 44.992-45.504L467.2 572.608 689.28 349.44a32 32 0 0 1 45.312-0.128z" fill="#27ae60"></path></svg></a><span class="vbadge">博主</span><!--v-if--><span class="vtime">2022-12-05</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome107.0</span><span>Mac OS 10.15.7</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#638862c5dbcffd000873c233" xlink:show="new">@czp</a>: ros 会自动检查 gateway 是否合法，如果你设置的 ip 不在它的接口网段范围内是不会生效的，你把 gateway 设置为旁路由/透明代理的 ip 就可以了</p>
</div><!--v-if--><!--v-if--></div></div></div></div></div><div class="vitem" id="6360bcc5e7119f00093cb8b7"><img class="vuser" aria-hidden="true" src="./post_files/a208828f487c5b0bb9ded8baa12df24e"><div class="vcard"><div class="vhead"><span class="vnick">WuhanSy<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-11-01</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome106.0</span><span>Mac OS 10.15.7</span></div><div class="vcontent"><p>请问博主 ubuntu 部署mosdns-cn和clash tun在同一个ip中,mosdns-cn 监听53 clash 监听5335,主路由ros dns 指向ubuntu后,访问不成功.我这么部署有什么问题吗?</p>
</div><!--v-if--><div class="vquote"><div class="vitem" id="6361c2115c812b000946d0ce"><img class="vuser" aria-hidden="true" src="./post_files/32436597"><div class="vcard"><div class="vhead"><a class="vnick" href="https://blog.lv5.moe/" target="_blank" rel="nofollow noreferrer">SSpirits<svg class="verified-icon" viewBox="0 0 1024 1024" width="14" height="14"><path d="M512 44.608l388.352 109.696a38.016 38.016 0 0 1 27.648 36.608v337.984c-1.984 110.528-40.192 207.04-113.984 288-73.92 81.024-172.48 134.528-294.592 160.32l-8.192 1.728-8.192-2.048c-127.616-32.832-225.536-85.952-293.056-160-68.096-74.688-105.984-171.584-113.92-289.28L96 526.336V190.976c0-17.024 11.328-32 27.648-36.608L512 44.608z m0 74.816L168 216.64v307.328l0.128 1.856c7.232 99.712 38.4 179.52 93.44 240.704l1.664 1.92c55.488 60.8 137.728 106.304 247.488 136l2.048 0.512 1.408-0.32c102.272-23.232 183.552-67.968 244.736-134.144l1.92-2.112c62.592-68.672 94.08-149.376 95.168-243.584V216.64L512 119.36z m222.592 229.888a32 32 0 0 1 0.448 44.864l-0.384 0.384-244.8 246.016a32 32 0 0 1-44.992 0.384l-0.384-0.384-155.136-155.968a32 32 0 0 1 44.992-45.504L467.2 572.608 689.28 349.44a32 32 0 0 1 45.312-0.128z" fill="#27ae60"></path></svg></a><span class="vbadge">博主</span><!--v-if--><span class="vtime">2022-11-02</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome107.0</span><span>Android 12</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#6360bcc5e7119f00093cb8b7" xlink:show="new">@WuhanSy</a>: 看一下你获取到的 dns 是否正确，mosdns 的分流规则和上游 dns 有没有问题，clash 的 fake ip 的路由有没有加</p>
</div><!--v-if--><!--v-if--></div></div><div class="vitem" id="636783a0f5a59400089fb924"><img class="vuser" aria-hidden="true" src="./post_files/a208828f487c5b0bb9ded8baa12df24e"><div class="vcard"><div class="vhead"><span class="vnick">WuhanSy<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-11-06</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome107.0</span><span>Windows 10</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#6361c2115c812b000946d0ce" xlink:show="new">@SSpirits</a>: 感觉都没有问题，mtr -r --tcp <a href="http://www.baidu.com/" target="_blank" rel="noreferrer noopener">www.baidu.com</a> 检测都不能通过。不知道哪步出了问题</p>
</div><!--v-if--><!--v-if--></div></div><div class="vitem" id="638deb5bc695be0008b6a7ad"><img class="vuser" aria-hidden="true" src="./post_files/32436597"><div class="vcard"><div class="vhead"><a class="vnick" href="https://blog.lv5.moe/" target="_blank" rel="nofollow noreferrer">SSpirits<svg class="verified-icon" viewBox="0 0 1024 1024" width="14" height="14"><path d="M512 44.608l388.352 109.696a38.016 38.016 0 0 1 27.648 36.608v337.984c-1.984 110.528-40.192 207.04-113.984 288-73.92 81.024-172.48 134.528-294.592 160.32l-8.192 1.728-8.192-2.048c-127.616-32.832-225.536-85.952-293.056-160-68.096-74.688-105.984-171.584-113.92-289.28L96 526.336V190.976c0-17.024 11.328-32 27.648-36.608L512 44.608z m0 74.816L168 216.64v307.328l0.128 1.856c7.232 99.712 38.4 179.52 93.44 240.704l1.664 1.92c55.488 60.8 137.728 106.304 247.488 136l2.048 0.512 1.408-0.32c102.272-23.232 183.552-67.968 244.736-134.144l1.92-2.112c62.592-68.672 94.08-149.376 95.168-243.584V216.64L512 119.36z m222.592 229.888a32 32 0 0 1 0.448 44.864l-0.384 0.384-244.8 246.016a32 32 0 0 1-44.992 0.384l-0.384-0.384-155.136-155.968a32 32 0 0 1 44.992-45.504L467.2 572.608 689.28 349.44a32 32 0 0 1 45.312-0.128z" fill="#27ae60"></path></svg></a><span class="vbadge">博主</span><!--v-if--><span class="vtime">2022-12-05</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome107.0</span><span>Mac OS 10.15.7</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#636783a0f5a59400089fb924" xlink:show="new">@WuhanSy</a>: 既然都用 mtr 了，看一下每一跳的 ip 都是什么，在哪一跳不通的就知道问题了</p>
</div><!--v-if--><!--v-if--></div></div></div></div></div><div class="vitem" id="6337f5adae9d630009b4d39a"><img class="vuser" aria-hidden="true" src="./post_files/9ea4f97777eb29cb641f56dce8aa9df0"><div class="vcard"><div class="vhead"><span class="vnick">Anguiao<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-10-01</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Edge105.0</span><span>Linux x86_64</span></div><div class="vcontent"><p>我也是想到了用DNS分流的方案，看下来很有启发，等折腾完了再来交流<img alt="1f923" src="https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji/1f923.png" class="vemoji"></p>
</div><!--v-if--><div class="vquote"></div></div></div><div class="vitem" id="6334b90f0bd000000902e403"><img class="vuser" aria-hidden="true" src="./post_files/5d28d388a610cf50c8bd17f9544a3fe1"><div class="vcard"><div class="vhead"><span class="vnick">Lee<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-09-29</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome105.0</span><span>Android 13</span></div><div class="vcontent"><p>请教一下博主，将中国域名加入fake ip filter的目的是什么，我看分流器不是已经提前分流了吗</p>
</div><!--v-if--><div class="vquote"><div class="vitem" id="6334bbbdfc787c0009ec5aaa"><img class="vuser" aria-hidden="true" src="./post_files/5d28d388a610cf50c8bd17f9544a3fe1"><div class="vcard"><div class="vhead"><span class="vnick">Lee<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-09-29</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome105.0</span><span>Android 13</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#6334b90f0bd000000902e403" xlink:show="new">@Lee</a>: 哦，是我没看仔细，和下面的看混了，楼主请无视</p>
</div><!--v-if--><!--v-if--></div></div><div class="vitem" id="63352751306c980009ab9950"><img class="vuser" aria-hidden="true" src="./post_files/ee830859977a3b58c60e1b8bbac6f33d"><div class="vcard"><div class="vhead"><span class="vnick">Lee<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-09-29</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome106.0</span><span>Linux x86_64</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#6334b90f0bd000000902e403" xlink:show="new">@Lee</a>: 我按楼主的思路实践成功了，稍微改进了下，clash 的dns server设置为mosdns，又返回mosdns进行remote 解析，充分榨干mosdns</p>
</div><!--v-if--><!--v-if--></div></div></div></div></div><div class="vitem" id="630c3a7f2e9d770009961a82"><img class="vuser" aria-hidden="true" src="./post_files/03ceb01ec14b5114cdd6efcd784001ab"><div class="vcard"><div class="vhead"><span class="vnick">Kumiko<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-08-29</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome104.0</span><span>Linux x86_64</span></div><div class="vcontent"><p>赞</p>
</div><!--v-if--><div class="vquote"></div></div></div><div class="vitem" id="6305f26af87cb8000999e884"><img class="vuser" aria-hidden="true" src="./post_files/d54967ff799775da88fdb7f4cad0292f"><div class="vcard"><div class="vhead"><span class="vnick">something<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-08-24</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome104.0</span><span>Windows 10</span></div><div class="vcontent"><p>请教一下，mosdns的目的是dns分流，但是科学软件本身也有dns的分流，并且这个分流之后解析的结果还有可能写入ipset，2个分流以谁为准呢？mosdns如何与科学软件配合？</p>
</div><!--v-if--><div class="vquote"><div class="vitem" id="6306203e7120860009f0bc84"><img class="vuser" aria-hidden="true" src="./post_files/32436597"><div class="vcard"><div class="vhead"><a class="vnick" href="https://blog.lv5.moe/" target="_blank" rel="nofollow noreferrer">SSpirits<svg class="verified-icon" viewBox="0 0 1024 1024" width="14" height="14"><path d="M512 44.608l388.352 109.696a38.016 38.016 0 0 1 27.648 36.608v337.984c-1.984 110.528-40.192 207.04-113.984 288-73.92 81.024-172.48 134.528-294.592 160.32l-8.192 1.728-8.192-2.048c-127.616-32.832-225.536-85.952-293.056-160-68.096-74.688-105.984-171.584-113.92-289.28L96 526.336V190.976c0-17.024 11.328-32 27.648-36.608L512 44.608z m0 74.816L168 216.64v307.328l0.128 1.856c7.232 99.712 38.4 179.52 93.44 240.704l1.664 1.92c55.488 60.8 137.728 106.304 247.488 136l2.048 0.512 1.408-0.32c102.272-23.232 183.552-67.968 244.736-134.144l1.92-2.112c62.592-68.672 94.08-149.376 95.168-243.584V216.64L512 119.36z m222.592 229.888a32 32 0 0 1 0.448 44.864l-0.384 0.384-244.8 246.016a32 32 0 0 1-44.992 0.384l-0.384-0.384-155.136-155.968a32 32 0 0 1 44.992-45.504L467.2 572.608 689.28 349.44a32 32 0 0 1 45.312-0.128z" fill="#27ae60"></path></svg></a><span class="vbadge">博主</span><!--v-if--><span class="vtime">2022-08-24</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome104.0</span><span>Windows 10</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#6305f26af87cb8000999e884" xlink:show="new">@something</a>: 可以阅读下前言部分，有写明本文的适用场景</p>
</div><!--v-if--><!--v-if--></div></div></div></div></div><div class="vitem" id="62f4650bc8831a0009bd39fa"><img class="vuser" aria-hidden="true" src="./post_files/f6cfe6e59978b1bb04311df2d846c579"><div class="vcard"><div class="vhead"><span class="vnick">limon<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-08-11</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome103.0</span><span>Android 10</span></div><div class="vcontent"><p>这里 mosdns 的 remote-upsteam 是不是应该 clash 的 dns？</p>
</div><!--v-if--><div class="vquote"><div class="vitem" id="62f4811df44b190009557fc3"><img class="vuser" aria-hidden="true" src="./post_files/32436597"><div class="vcard"><div class="vhead"><a class="vnick" href="https://blog.lv5.moe/" target="_blank" rel="nofollow noreferrer">SSpirits<svg class="verified-icon" viewBox="0 0 1024 1024" width="14" height="14"><path d="M512 44.608l388.352 109.696a38.016 38.016 0 0 1 27.648 36.608v337.984c-1.984 110.528-40.192 207.04-113.984 288-73.92 81.024-172.48 134.528-294.592 160.32l-8.192 1.728-8.192-2.048c-127.616-32.832-225.536-85.952-293.056-160-68.096-74.688-105.984-171.584-113.92-289.28L96 526.336V190.976c0-17.024 11.328-32 27.648-36.608L512 44.608z m0 74.816L168 216.64v307.328l0.128 1.856c7.232 99.712 38.4 179.52 93.44 240.704l1.664 1.92c55.488 60.8 137.728 106.304 247.488 136l2.048 0.512 1.408-0.32c102.272-23.232 183.552-67.968 244.736-134.144l1.92-2.112c62.592-68.672 94.08-149.376 95.168-243.584V216.64L512 119.36z m222.592 229.888a32 32 0 0 1 0.448 44.864l-0.384 0.384-244.8 246.016a32 32 0 0 1-44.992 0.384l-0.384-0.384-155.136-155.968a32 32 0 0 1 44.992-45.504L467.2 572.608 689.28 349.44a32 32 0 0 1 45.312-0.128z" fill="#27ae60"></path></svg></a><span class="vbadge">博主</span><!--v-if--><span class="vtime">2022-08-11</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome104.0</span><span>Android 12</span></div><div class="vcontent"><p><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#62f4650bc8831a0009bd39fa" xlink:show="new">@limon</a>: 是的<br>
mosdns local upstream 是 adguard<br>
mosdns remote upstream 是 clash<br>
clash 的 dns server 也是 adguard</p>
</div><!--v-if--><!--v-if--></div></div></div></div></div><div class="vitem" id="62c6bc0fe2fa800009f9b919"><img class="vuser" aria-hidden="true" src="./post_files/g(1)"><div class="vcard"><div class="vhead"><span class="vnick">holand<!--v-if--></span><!--v-if--><!--v-if--><span class="vtime">2022-07-07</span><button class="vreply" title="回复"><svg viewBox="0 0 1024 1024" width="18" height="18"><path d="M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z" fill="currentColor"></path></svg></button></div><div class="vmeta" aria-hidden="true"><span>Chrome103.0</span><span>Android 12</span></div><div class="vcontent"><p>666</p>
</div><!--v-if--><div class="vquote"></div></div></div></div><!--v-if--><!--v-if--><!--v-if--></div></div><style>.waline-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}.waline-container .vcount{color:var(--card-text-color-main)}:root{--waline-theme-color:#0e6db1;--waline-active-color:#107fcf}</style><script>addLoadEvent(function(){new Waline({el:"#waline",dark:'html[data-scheme="dark"]',serverURL:"https://comment.lv5.moe",visitor:!0,copyright:!1,avatar:"retro",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/qq","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji"],requiredMeta:["nick","mail"]})})</script><footer class="site-footer"><section class="copyright">©
2020 -
2022 SSpiritsの秘密基地</section><section class="powerby">Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a><br>Theme <b><a href="https://github.com/ShadowySpirits/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> modified by <a href="https://blog.lv5.moe/" target="_blank" rel="noopener">SSpirits</a></section></footer><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title="Share"></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><script src="./post_files/photoswipe.min.js.下载" integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin="anonymous" defer=""></script><script src="./post_files/photoswipe-ui-default.min.js.下载" integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin="anonymous" defer=""></script><link rel="stylesheet" href="./post_files/default-skin.css" integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin="anonymous"><link rel="stylesheet" href="./post_files/photoswipe.css" integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin="anonymous"></main><aside class="sidebar right-sidebar sticky"><div id="article-toolbar"><a href="https://blog.lv5.moe/" class="back-home"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><polyline points="5 12 3 12 12 3 21 12 19 12"></polyline><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"></path><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"></path></svg><span>Home</span></a>
<a href="https://blog.lv5.moe/about" class="back-home"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="12" cy="7" r="4"></circle><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"></path></svg><span>About</span></a></div><form action="https://blog.lv5.moe/search" class="search-form widget"><p><label>Search</label>
<input name="keyword" required="" placeholder="Type something...">
<button title="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><circle cx="10" cy="10" r="7"></circle><line x1="21" y1="21" x2="15" y2="15"></line></svg></button></p></form><section class="widget archives"><div class="widget-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><line x1="5" y1="9" x2="19" y2="9"></line><line x1="5" y1="15" x2="19" y2="15"></line><line x1="11" y1="4" x2="7" y2="20"></line><line x1="17" y1="4" x2="13" y2="20"></line></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class="widget--toc"><nav id="TableOfContents"><ol><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#%E5%89%8D%E8%A8%80">前言</a></li><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">网络架构</a></li><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#dns-%E5%88%86%E6%B5%81%E9%85%8D%E7%BD%AE">DNS 分流配置</a><ol><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#%E6%9E%81%E7%AE%80%E9%85%8D%E7%BD%AE">极简配置</a></li><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#%E7%B2%BE%E5%87%86%E5%88%86%E6%B5%81%E9%85%8D%E7%BD%AE">精准分流配置</a></li><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#%E5%8E%BB%E5%B9%BF%E5%91%8Adns-%E8%A7%A3%E6%9E%90%E7%BB%9F%E8%AE%A1%E9%85%8D%E7%BD%AE">去广告/DNS 解析统计配置</a></li></ol></li><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE">其他配置</a><ol><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#%E8%87%AA%E5%8A%A8%E8%AE%BE%E7%BD%AE%E8%AE%BE%E5%A4%87%E7%9A%84-dns-%E6%9C%8D%E5%8A%A1%E5%99%A8">自动设置设备的 DNS 服务器</a></li><li><a href="https://blog.lv5.moe/p/use-dns-to-create-split-routing-for-different-domain-or-ip-ranges#%E4%B8%BA%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8-ip-%E7%9A%84-app-%E8%AE%BE%E7%BD%AE%E8%B7%AF%E7%94%B1">为直接使用 IP 的 APP 设置路由</a></li></ol></li></ol></nav></div></section><section class="widget archives"><div class="widget-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"></path></svg></div><h2 class="widget-title section-title">Archives</h2><div class="widget-archive--list"><div class="archives-year"><a href="https://blog.lv5.moe/archives#2022"><span class="year">2022</span>
<span class="count">8</span></a></div><div class="archives-year"><a href="https://blog.lv5.moe/archives#2021"><span class="year">2021</span>
<span class="count">5</span></a></div><div class="archives-year"><a href="https://blog.lv5.moe/archives#2019"><span class="year">2019</span>
<span class="count">17</span></a></div><div class="archives-year"><a href="https://blog.lv5.moe/archives#2018"><span class="year">2018</span>
<span class="count">6</span></a></div></div></section><section class="widget tagCloud"><div class="widget-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"></path><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"></path><circle cx="9" cy="9" r="2"></circle></svg></div><h2 class="widget-title section-title">Tags</h2><div class="tagCloud-tags"><a href="https://blog.lv5.moe/tags/typecho" class="font_size_4">Typecho</a>
<a href="https://blog.lv5.moe/tags/cdn" class="font_size_3">CDN</a>
<a href="https://blog.lv5.moe/tags/kotlin" class="font_size_3">Kotlin</a>
<a href="https://blog.lv5.moe/tags/linux" class="font_size_3">Linux</a>
<a href="https://blog.lv5.moe/tags/rocketmq" class="font_size_3">RocketMQ</a>
<a href="https://blog.lv5.moe/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6" class="font_size_3">中间件</a>
<a href="https://blog.lv5.moe/tags/%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7" class="font_size_3">可观测性</a>
<a href="https://blog.lv5.moe/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97" class="font_size_3">消息队列</a>
<a href="https://blog.lv5.moe/tags/android" class="font_size_2">Android</a>
<a href="https://blog.lv5.moe/tags/bt/pt" class="font_size_2">BT/PT</a>
<a href="https://blog.lv5.moe/tags/cloudflare" class="font_size_2">Cloudflare</a>
<a href="https://blog.lv5.moe/tags/db" class="font_size_2">DB</a>
<a href="https://blog.lv5.moe/tags/java" class="font_size_2">Java</a>
<a href="https://blog.lv5.moe/tags/kubernetes" class="font_size_2">Kubernetes</a>
<a href="https://blog.lv5.moe/tags/laravel" class="font_size_2">Laravel</a>
<a href="https://blog.lv5.moe/tags/math" class="font_size_2">Math</a>
<a href="https://blog.lv5.moe/tags/nginx" class="font_size_2">Nginx</a>
<a href="https://blog.lv5.moe/tags/operating-system" class="font_size_2">Operating System</a>
<a href="https://blog.lv5.moe/tags/php" class="font_size_2">PHP</a>
<a href="https://blog.lv5.moe/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90" class="font_size_2">源码分析</a>
<a href="https://blog.lv5.moe/tags/alibaba-cloud" class="font_size_1">Alibaba Cloud</a>
<a href="https://blog.lv5.moe/tags/clash" class="font_size_1">Clash</a>
<a href="https://blog.lv5.moe/tags/codec" class="font_size_1">Codec</a>
<a href="https://blog.lv5.moe/tags/concurrent" class="font_size_1">Concurrent</a>
<a href="https://blog.lv5.moe/tags/crack" class="font_size_1">Crack</a>
<a href="https://blog.lv5.moe/tags/dns" class="font_size_1">DNS</a>
<a href="https://blog.lv5.moe/tags/file-system" class="font_size_1">File System</a>
<a href="https://blog.lv5.moe/tags/font" class="font_size_1">font</a>
<a href="https://blog.lv5.moe/tags/hackintosh" class="font_size_1">Hackintosh</a>
<a href="https://blog.lv5.moe/tags/homelab" class="font_size_1">HomeLab</a>
<a href="https://blog.lv5.moe/tags/hugo" class="font_size_1">Hugo</a>
<a href="https://blog.lv5.moe/tags/iptables" class="font_size_1">iptables</a>
<a href="https://blog.lv5.moe/tags/k3s" class="font_size_1">K3s</a>
<a href="https://blog.lv5.moe/tags/kms" class="font_size_1">KMS</a>
<a href="https://blog.lv5.moe/tags/macos" class="font_size_1">MacOS</a>
<a href="https://blog.lv5.moe/tags/media" class="font_size_1">Media</a>
<a href="https://blog.lv5.moe/tags/metrics" class="font_size_1">Metrics</a>
<a href="https://blog.lv5.moe/tags/mosdns" class="font_size_1">MosDNS</a>
<a href="https://blog.lv5.moe/tags/mysql" class="font_size_1">Mysql</a>
<a href="https://blog.lv5.moe/tags/nas" class="font_size_1">NAS</a>
<a href="https://blog.lv5.moe/tags/nextcloud" class="font_size_1">Nextcloud</a>
<a href="https://blog.lv5.moe/tags/oss" class="font_size_1">OSS</a>
<a href="https://blog.lv5.moe/tags/pbr" class="font_size_1">PBR</a>
<a href="https://blog.lv5.moe/tags/pve" class="font_size_1">PVE</a>
<a href="https://blog.lv5.moe/tags/rancher" class="font_size_1">Rancher</a>
<a href="https://blog.lv5.moe/tags/serverless" class="font_size_1">Serverless</a>
<a href="https://blog.lv5.moe/tags/spring" class="font_size_1">Spring</a>
<a href="https://blog.lv5.moe/tags/ssl" class="font_size_1">SSL</a>
<a href="https://blog.lv5.moe/tags/traefik" class="font_size_1">Traefik</a>
<a href="https://blog.lv5.moe/tags/vercel" class="font_size_1">Vercel</a>
<a href="https://blog.lv5.moe/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86" class="font_size_1">内存管理</a>
<a href="https://blog.lv5.moe/tags/%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB" class="font_size_1">博客迁移</a>
<a href="https://blog.lv5.moe/tags/%E5%8F%88%E6%8B%8D%E4%BA%91" class="font_size_1">又拍云</a>
<a href="https://blog.lv5.moe/tags/%E5%9D%97%E5%AD%98%E5%82%A8" class="font_size_1">块存储</a>
<a href="https://blog.lv5.moe/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8" class="font_size_1">对象存储</a>
<a href="https://blog.lv5.moe/tags/%E7%AD%96%E7%95%A5%E8%B7%AF%E7%94%B1" class="font_size_1">策略路由</a>
<a href="https://blog.lv5.moe/tags/%E9%98%BF%E9%87%8C%E4%BA%91" class="font_size_1">阿里云</a>
<a href="https://blog.lv5.moe/tags/%E9%BB%91%E8%8B%B9%E6%9E%9C" class="font_size_1">黑苹果</a></div></section></aside></div><script src="./post_files/vibrant.min.js.下载" integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin="anonymous" defer=""></script><script type="text/javascript" src="./post_files/main.js.下载" defer=""></script>
<script async="" defer="" src="./post_files/mermaid.min.js.下载"></script>
<script>addLoadEvent(function(){mermaid.initialize({theme:document.documentElement.dataset.scheme==="dark"?"dark":"default",startOnLoad:!0})})</script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script type="text/javascript">console.log("%c SSpiritsの秘密基地 %c わたし、気になります！ ","color: #fff; margin: 1em 0; padding: 5px 0; background: #3498db;","margin: 1em 0; padding: 5px 0; background: #efefef;")</script><script>if(!window.location.pathname.startsWith("/p/"))for(var x=document.getElementById("visitor-count");x!=null;)x.remove(),x=document.getElementById("visitor-count")</script><div class="mermaidTooltip" style="opacity: 0;"></div><quillbot-extension-portal></quillbot-extension-portal></body><quillbot-extension-root></quillbot-extension-root></html>